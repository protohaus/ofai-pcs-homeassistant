[{"id":"4d69908ddcfaac9c","type":"tab","label":"main","disabled":false,"info":"","env":[]},{"id":"8ecde103e664eec0","type":"tab","label":"cameras_manually","disabled":false,"info":"","env":[]},{"id":"2709ed20d07ea830","type":"tab","label":"telegram_bot","disabled":false,"info":"","env":[]},{"id":"c7fa6c57.aa19e","type":"tab","label":"led_control","disabled":false,"info":""},{"id":"0a84fcef42ddc94e","type":"tab","label":"Flow 1","disabled":true,"info":"","env":[]},{"id":"ab1036a4c01aab80","type":"subflow","name":"Picture","info":"","category":"","in":[{"x":40,"y":280,"wires":[{"id":"1b2a050c6aeb59a3"}]}],"out":[{"x":1240,"y":300,"wires":[{"id":"339e9f949a87e978","port":0},{"id":"3f7ee72a99f31698","port":0},{"id":"9cd59682cb6e706a","port":0},{"id":"3d50fa9f3089425e","port":0},{"id":"399aec1c9bc888a5","port":0},{"id":"bab8f70489938717","port":0},{"id":"2e52f87077047aa1","port":0},{"id":"f98ff7bd174079fc","port":0},{"id":"a2098170b1d4826f","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"48c607f195e854e0","type":"subflow","name":"Sensor","info":"","category":"","in":[{"x":260,"y":160,"wires":[{"id":"018890c568724ccb"}]}],"out":[{"x":1900,"y":1900,"wires":[{"id":"d191939ade03b663","port":0},{"id":"3de2061006ed4f14","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"b23737722e71b01c","type":"subflow","name":"Status","info":"","category":"","in":[{"x":120,"y":100,"wires":[{"id":"15c51c2042b7ed22"}]}],"out":[{"x":2960,"y":1180,"wires":[{"id":"e5275f00efd0cfaf","port":0},{"id":"5ce807b09bcd0106","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"9e7ca1741a410453","type":"subflow","name":"Restart","info":"","category":"","in":[{"x":100,"y":200,"wires":[{"id":"4611608905aa7003"}]}],"out":[{"x":1300,"y":160,"wires":[{"id":"9870875b85e30781","port":0},{"id":"a0b78b93d8cee4bb","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"ca65c1dbac21ab41","type":"subflow","name":"Power","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"922a8d6a1d97d0ef"}]}],"out":[{"x":900,"y":180,"wires":[{"id":"78872f6d664a1dc4","port":0},{"id":"995a79c0d062cc28","port":0},{"id":"117dd8d8bf3522f8","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"6c80f1ca0dd2938f","type":"subflow","name":"get_plant","info":"","category":"","in":[{"x":100,"y":160,"wires":[{"id":"84751c5bb01f818c"}]}],"out":[{"x":500,"y":160,"wires":[{"id":"7983922acada6878","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"d2fb9f710e7a6826","type":"subflow","name":"get_angles","info":"","category":"","in":[{"x":260,"y":40,"wires":[{"id":"5237d65b65725854"}]}],"out":[{"x":1180,"y":40,"wires":[{"id":"3070e3c89ed7402b","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"4e99185239cf91b2","type":"subflow","name":"photo_path_manual","info":"","category":"","in":[{"x":220,"y":140,"wires":[{"id":"886628d2be68f0a7"}]}],"out":[{"x":740,"y":140,"wires":[{"id":"886628d2be68f0a7","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"3ce6ca2f6197961a","type":"subflow","name":"state_homing_valid","info":"","category":"","in":[{"x":80,"y":160,"wires":[{"id":"73568eaefee8249e"}]}],"out":[{"x":580,"y":140,"wires":[{"id":"fdb455407f39d736","port":0}]},{"x":580,"y":200,"wires":[{"id":"fdb455407f39d736","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"d8b948f39935830f","type":"subflow","name":"state_motor_enabled","info":"","category":"","in":[{"x":160,"y":60,"wires":[{"id":"c26543d53a9d3aaf"}]}],"out":[{"x":620,"y":40,"wires":[{"id":"19c37ec56a0b6d94","port":0}]},{"x":620,"y":100,"wires":[{"id":"19c37ec56a0b6d94","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"fd625c48e8c8ae90","type":"subflow","name":"get_automation_main_state","info":"","category":"","in":[{"x":40,"y":120,"wires":[{"id":"781da8795bb615f9"}]}],"out":[{"x":560,"y":80,"wires":[{"id":"e91504ef7f6314bd","port":0}]},{"x":560,"y":160,"wires":[{"id":"e91504ef7f6314bd","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"53bd181b0b773e57","type":"subflow","name":"state_stepper_mode","info":"","category":"","in":[{"x":80,"y":260,"wires":[{"id":"882565c3c6febbca"}]}],"out":[{"x":1060,"y":100,"wires":[{"id":"88807011f51d9ec0","port":0}]},{"x":1060,"y":160,"wires":[{"id":"88807011f51d9ec0","port":1}]},{"x":1060,"y":220,"wires":[{"id":"88807011f51d9ec0","port":2}]},{"x":1060,"y":280,"wires":[{"id":"88807011f51d9ec0","port":3}]},{"x":1060,"y":340,"wires":[{"id":"88807011f51d9ec0","port":4}]},{"x":1060,"y":400,"wires":[{"id":"88807011f51d9ec0","port":5}]},{"x":1060,"y":460,"wires":[{"id":"88807011f51d9ec0","port":6}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"2d3973ed11ae3dc8","type":"subflow","name":"get_pcs","info":"","category":"","in":[{"x":180,"y":100,"wires":[{"id":"88b036a8fe3db20f"}]}],"out":[{"x":620,"y":60,"wires":[{"id":"e14c14ab4bdfd14d","port":0}]},{"x":620,"y":140,"wires":[{"id":"ee57bbb2778ce146","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"60792d08bd7f197a","type":"subflow","name":"get_automation_kinematics_state","info":"","category":"","in":[{"x":160,"y":140,"wires":[{"id":"4188f9afebc687af"}]}],"out":[{"x":720,"y":100,"wires":[{"id":"e6f58aca0f6eda21","port":0}]},{"x":720,"y":180,"wires":[{"id":"e6f58aca0f6eda21","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"214e5ec186f9b89b","type":"subflow","name":"homing_active","info":"","category":"","in":[{"x":140,"y":200,"wires":[{"id":"317f2e2d7f56552a"}]}],"out":[{"x":860,"y":160,"wires":[{"id":"4aa83709dad5694c","port":0}]},{"x":860,"y":240,"wires":[{"id":"4aa83709dad5694c","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"564c0776b24ee8cb","type":"subflow","name":"get_maintenance_mode","info":"","category":"","in":[{"x":80,"y":120,"wires":[{"id":"2aa62311bc7126dc"}]}],"out":[{"x":500,"y":80,"wires":[{"id":"e5f8e1f5b3813e67","port":0}]},{"x":500,"y":140,"wires":[{"id":"e5f8e1f5b3813e67","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"502d9caae1f74190","type":"subflow","name":"state_kin_stepper_start_automation","info":"","category":"","in":[{"x":220,"y":140,"wires":[{"id":"627d1a455e5f15fa"}]}],"out":[{"x":840,"y":100,"wires":[{"id":"7d7f607e55f62188","port":0}]},{"x":840,"y":180,"wires":[{"id":"7d7f607e55f62188","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"01e96d9e32906378","type":"subflow","name":"get_kinematics_state","info":"","category":"","in":[{"x":120,"y":140,"wires":[{"id":"1d3cb6856191dcb7"}]}],"out":[{"x":1040,"y":140,"wires":[{"id":"b35a0db0090b2484","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"69b5998777ae11cf","type":"subflow","name":"camera_snapshot","info":"","category":"","in":[{"x":300,"y":200,"wires":[{"id":"11eab4e996d21a25"}]}],"out":[{"x":980,"y":200,"wires":[{"id":"2ffbcecb6e53fb32","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"6b9686a43efc2793","type":"subflow","name":"state_pictures_taken","info":"","category":"","in":[{"x":160,"y":220,"wires":[{"id":"e6f520ae7555c911"}]}],"out":[{"x":660,"y":200,"wires":[{"id":"b3dae0b521d9265c","port":0}]},{"x":680,"y":260,"wires":[{"id":"b3dae0b521d9265c","port":1}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"5d0919c9d3075c28","type":"junction","z":"4d69908ddcfaac9c","x":240,"y":260,"wires":[["5da34bb65134cb2c","2eae561fda2da48e"]]},{"id":"f5bf6da227d8fd7c","type":"junction","z":"4d69908ddcfaac9c","x":540,"y":240,"wires":[["c978bd58fb047143","cbd81bb84ebfbb56"]]},{"id":"fe62be6513b13470","type":"junction","z":"4d69908ddcfaac9c","x":780,"y":300,"wires":[["892c3c06315a9491"]]},{"id":"70353ed3948ad466","type":"junction","z":"4d69908ddcfaac9c","x":100,"y":1180,"wires":[["b7924b4f3fa4598e"]]},{"id":"0216d89de9c60617","type":"junction","z":"4d69908ddcfaac9c","x":220,"y":1120,"wires":[["70353ed3948ad466"]]},{"id":"4627b5df7fc5784e","type":"junction","z":"4d69908ddcfaac9c","x":1100,"y":1400,"wires":[["c2bff661a182021f"]]},{"id":"53e7b0d744ab813b","type":"junction","z":"4d69908ddcfaac9c","x":980,"y":1320,"wires":[["c2bff661a182021f"]]},{"id":"c2bff661a182021f","type":"junction","z":"4d69908ddcfaac9c","x":1180,"y":1320,"wires":[["5a1dd045f3f8a36a"]]},{"id":"73566d2d8e057e68","type":"junction","z":"4d69908ddcfaac9c","x":980,"y":1240,"wires":[["c2bff661a182021f"]]},{"id":"d3b3077d3b65f1ce","type":"junction","z":"4d69908ddcfaac9c","x":980,"y":1160,"wires":[["c2bff661a182021f"]]},{"id":"5cd0cd072ca0b8d9","type":"junction","z":"4d69908ddcfaac9c","x":1120,"y":1560,"wires":[["5a1dd045f3f8a36a"]]},{"id":"5a1dd045f3f8a36a","type":"junction","z":"4d69908ddcfaac9c","x":1280,"y":1480,"wires":[["a03d265efa3a0ed4"]]},{"id":"801a95bfa47e4966","type":"junction","z":"4d69908ddcfaac9c","x":1120,"y":1740,"wires":[["0e7d918107d2ce4a"]]},{"id":"0e7d918107d2ce4a","type":"junction","z":"4d69908ddcfaac9c","x":1280,"y":1480,"wires":[[]]},{"id":"f482c16b.7b4d","type":"server","name":"Home Assistant","version":2,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"","connectionDelay":false,"cacheJson":true,"heartbeat":true,"heartbeatInterval":"30"},{"id":"090665a04fa6c385","type":"mqtt-broker","name":"Homeassistant MQTT Broker","broker":"127.0.0.1","port":"1883","clientid":"","autoConnect":true,"usetls":false,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"ef067c6f.620e6","type":"server","name":"hass.io","version":2,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":false,"cacheJson":true,"heartbeat":false,"heartbeatInterval":"30"},{"id":"62d7bb2f.196044","type":"server","d":true,"name":"ESP Home","version":2,"addon":false,"rejectUnauthorizedCerts":true,"ha_boolean":"","connectionDelay":false,"cacheJson":false,"heartbeat":true,"heartbeatInterval":"10"},{"id":"d28c9492.f419c8","type":"server","name":"","version":2,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"","connectionDelay":false,"cacheJson":false,"heartbeat":false,"heartbeatInterval":""},{"id":"2dde05e9153f7e26","type":"ui_tab","name":"Home","icon":"dashboard","disabled":false,"hidden":false},{"id":"7724bf65801a42b3","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD.MM.YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"5fde6ffd3a8708d4","type":"ui_group","name":"Standard","tab":"2dde05e9153f7e26","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"250eeee2.afada2","type":"mqtt-broker","name":"192.168.1.8","broker":"192.168.1.8","port":"1883","clientid":"","autoConnect":true,"usetls":false,"compatmode":false,"protocolVersion":4,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"a526e1d6acb6b7ab","type":"telegram bot","botname":"protohaus-ofai-pcs","usernames":"CptPingui,Mon92BS","chatids":"-1001698219543","baseapiurl":"","updatemode":"polling","pollinterval":"300","usesocks":false,"sockshost":"","socksport":"6667","socksusername":"anonymous","sockspassword":"","bothost":"","botpath":"","localbotport":"8443","publicbotport":"8443","privatekey":"","certificate":"","useselfsignedcertificate":false,"sslterminated":false,"verboselogging":false},{"id":"d73229eefcbd69e2","type":"telegrambot-config","d":true,"botname":"protohaus-ofai-pcs","usernames":"CptPingui,","chatIds":"-1001698219543,","pollInterval":"300"},{"id":"51a30dc2.5c61a4","type":"server","name":"Home Assistant","addon":true},{"id":"fdbea5e0.730e08","type":"http request","z":"ab1036a4c01aab80","name":"","method":"GET","ret":"bin","paytoqs":"ignore","url":"192.168.188.65/picture/1/current/","tls":"","persist":false,"proxy":"","authType":"basic","senderr":false,"headers":[],"x":470,"y":520,"wires":[["3f7ee72a99f31698"]]},{"id":"25e3021fefb298c5","type":"comment","z":"ab1036a4c01aab80","name":"IP Camera Configuration","info":"","x":510,"y":480,"wires":[]},{"id":"a2098170b1d4826f","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam1`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":120,"wires":[[]]},{"id":"173ab3da1bddfcbd","type":"comment","z":"ab1036a4c01aab80","name":"ESP32 Camera Configuration","info":"","x":520,"y":80,"wires":[]},{"id":"43399e15d0db9da5","type":"api-call-service","z":"ab1036a4c01aab80","name":"Snapshot pcs1.cam1","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.pcs1_cam1_camera","data":"{\"filename\":\"/config/www/pcs1_cam1.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":500,"y":120,"wires":[["b1ef6fc950ef5462"]]},{"id":"b1ef6fc950ef5462","type":"file in","z":"ab1036a4c01aab80","name":"load image","filename":"/config/www/pcs1_cam1.jpg","filenameType":"str","format":"","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":690,"y":120,"wires":[["a2098170b1d4826f"]]},{"id":"1b2a050c6aeb59a3","type":"switch","z":"ab1036a4c01aab80","name":"Choose Cam","property":"originalMessage.text","propertyType":"msg","rules":[{"t":"eq","v":"/pic_pcs1_cam1","vt":"str"},{"t":"eq","v":"/pic_pcs1_cam2","vt":"str"},{"t":"eq","v":"/pic_pcs1_cam3","vt":"str"},{"t":"eq","v":"/pic_pcs1_cam4","vt":"str"},{"t":"eq","v":"/pic_pcs1_cam5","vt":"str"},{"t":"eq","v":"/pic_pcs1_cam6","vt":"str"},{"t":"eq","v":"/pic_pcs1_cam7","vt":"str"},{"t":"eq","v":"/pic_pcs1_all","vt":"str"},{"t":"eq","v":"/pic_all","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":10,"x":190,"y":280,"wires":[["43399e15d0db9da5"],["08260b977be2b610"],["11110b9b342bbb1f"],["1330d7d89ea87472"],["f84afacb92a942cc"],["479df0f5d416a6f1"],["7d6aba86bc174503"],["7d6aba86bc174503","479df0f5d416a6f1","f84afacb92a942cc","1330d7d89ea87472","11110b9b342bbb1f","08260b977be2b610","43399e15d0db9da5"],["43399e15d0db9da5","08260b977be2b610","11110b9b342bbb1f","1330d7d89ea87472","f84afacb92a942cc","479df0f5d416a6f1","7d6aba86bc174503"],["339e9f949a87e978"]]},{"id":"08260b977be2b610","type":"api-call-service","z":"ab1036a4c01aab80","name":"Snapshot pcs1.cam2","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.pcs1_cam2_camera","data":"{\"filename\":\"/config/www/pcs1_cam2.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":500,"y":160,"wires":[["0f074779063b0565"]]},{"id":"0f074779063b0565","type":"file in","z":"ab1036a4c01aab80","name":"load image","filename":"/config/www/pcs1_cam2.jpg","filenameType":"str","format":"","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":690,"y":160,"wires":[["f98ff7bd174079fc"]]},{"id":"11110b9b342bbb1f","type":"api-call-service","z":"ab1036a4c01aab80","name":"Snapshot pcs1.cam3","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.pcs1_cam3_camera","data":"{\"filename\":\"/config/www/pcs1_cam3.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":500,"y":200,"wires":[["d6286627733658d0"]]},{"id":"d6286627733658d0","type":"file in","z":"ab1036a4c01aab80","name":"load image","filename":"/config/www/pcs1_cam3.jpg","filenameType":"str","format":"","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":690,"y":200,"wires":[["2e52f87077047aa1"]]},{"id":"1330d7d89ea87472","type":"api-call-service","z":"ab1036a4c01aab80","name":"Snapshot pcs1.cam4","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.pcs1_cam4_camera","data":"{\"filename\":\"/config/www/pcs1_cam4.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":500,"y":240,"wires":[["9b3fa02b9dd46aca"]]},{"id":"9b3fa02b9dd46aca","type":"file in","z":"ab1036a4c01aab80","name":"load image","filename":"/config/www/pcs1_cam4.jpg","filenameType":"str","format":"","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":690,"y":240,"wires":[["bab8f70489938717"]]},{"id":"f84afacb92a942cc","type":"api-call-service","z":"ab1036a4c01aab80","name":"Snapshot pcs1.cam5","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.pcs1_cam5_camera","data":"{\"filename\":\"/config/www/pcs1_cam5.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":500,"y":280,"wires":[["14327525df6f7489"]]},{"id":"14327525df6f7489","type":"file in","z":"ab1036a4c01aab80","name":"load image","filename":"/config/www/pcs1_cam5.jpg","filenameType":"str","format":"","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":690,"y":280,"wires":[["399aec1c9bc888a5"]]},{"id":"479df0f5d416a6f1","type":"api-call-service","z":"ab1036a4c01aab80","name":"Snapshot pcs1.cam6","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.pcs1_cam6_camera","data":"{\"filename\":\"/config/www/pcs1_cam6.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":500,"y":320,"wires":[["1a8d6b101365b544"]]},{"id":"1a8d6b101365b544","type":"file in","z":"ab1036a4c01aab80","name":"load image","filename":"/config/www/pcs1_cam6.jpg","filenameType":"str","format":"","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":690,"y":320,"wires":[["3d50fa9f3089425e"]]},{"id":"7d6aba86bc174503","type":"api-call-service","z":"ab1036a4c01aab80","name":"Snapshot pcs1.cam7","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.pcs1_cam7_camera","data":"{\"filename\":\"/config/www/pcs1_cam7.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":500,"y":360,"wires":[["4f37124a1bb6b24d"]]},{"id":"4f37124a1bb6b24d","type":"file in","z":"ab1036a4c01aab80","name":"load image","filename":"/config/www/pcs1_cam7.jpg","filenameType":"str","format":"","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":690,"y":360,"wires":[["9cd59682cb6e706a"]]},{"id":"339e9f949a87e978","type":"function","z":"ab1036a4c01aab80","name":"help Message","func":"var message = \n`\n*You requested an unknown camera*\n\nPlease use one of the following commands\\\\:\n\n/help\n/pic\\\\_pcs1\\\\_cam1\n/pic\\\\_pcs1\\\\_cam2\n/pic\\\\_pcs1\\\\_cam3\n/pic\\\\_pcs1\\\\_cam4\n/pic\\\\_pcs1\\\\_cam5\n/pic\\\\_pcs1\\\\_cam6\n/pic\\\\_pcs1\\\\_cam7\n/pic\\\\_pcs1\\\\_all\n/pic\\\\_all\n`;\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":620,"wires":[[]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"f98ff7bd174079fc","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam2`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":160,"wires":[[]]},{"id":"2e52f87077047aa1","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam3`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":200,"wires":[[]]},{"id":"bab8f70489938717","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam4`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":240,"wires":[[]]},{"id":"399aec1c9bc888a5","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam5`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":280,"wires":[[]]},{"id":"3d50fa9f3089425e","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam6`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":320,"wires":[[]]},{"id":"9cd59682cb6e706a","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam7`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":360,"wires":[[]]},{"id":"3f7ee72a99f31698","type":"function","z":"ab1036a4c01aab80","name":"send picture","func":"var pl = {\n  content: msg.payload,\n  caption: `Picture: pcs1_cam8`,\n  type: 'photo',\n  chatId: msg.originalMessage.chat.id,\n  chat: msg.originalMessage.chat,\n  from: msg.originalMessage.from,\n  message_id: msg.originalMessage.message_id\n}\n\nmsg.payload = pl;\n\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":520,"wires":[[]]},{"id":"4c69704eea8fe93b","type":"comment","z":"ab1036a4c01aab80","name":"Camera Configuration","info":"","x":140,"y":40,"wires":[]},{"id":"a9d35b21f14734cc","type":"comment","z":"48c607f195e854e0","name":"Sensor Data Configuration","info":"","x":190,"y":80,"wires":[]},{"id":"3de2061006ed4f14","type":"function","z":"48c607f195e854e0","name":"send message","func":"var message = msg.sensor_values;\nmsg.payload = msg.telegram_message;\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1720,"y":1840,"wires":[[]]},{"id":"9646d923.432558","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_growth_chamber_average_humidity","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_growth_chamber_average_humidity","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_growth_chamber_average_humidity","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":880,"y":1220,"wires":[["d92bf2f0.d578"]]},{"id":"d92bf2f0.d578","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_growth_chamber_average_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_growth_chamber_average_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_growth_chamber_average_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":890,"y":1280,"wires":[["ec9f0147.f77b2"]]},{"id":"ec9f0147.f77b2","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_growth_chamber_average_illuminance","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_growth_chamber_average_illuminance","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_growth_chamber_average_illuminance","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":890,"y":1340,"wires":[["cf2310f2b0f381a8"]]},{"id":"67634f6c.20eb7","type":"template","z":"48c607f195e854e0","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System 1 \\- Sensor Data__*\n\n*Power Consumption*\nEnergy total\\: {{pcs1_main_energy}} kWh\nPower total\\: {{pcs1_main_power}} W\n\n*Amperage*\nKinematics\\: {{pcs1_kin_current}} A\nLED1 Hall A\\: {{pcs1_led1_hall_a_current}} A\nLED1 Hall B\\: {{pcs1_led1_hall_b_current}} A\nLED2 Hall A\\: {{pcs1_led2_hall_a_current}} A\nLED2 Hall B\\: {{pcs1_led2_hall_b_current}} A\nLED3 Hall A\\: {{pcs1_led3_hall_a_current}} A\nLED4 Hall A\\: {{pcs1_led4_hall_a_current}} A\n\n*Outside*\nTemperature\\: {{pcs1_outside_average_temperature}} °C\n\n*Electronics Chamber*\nTemperature\\: {{pcs1_pwm_dallas_1_temperature}} °C\nTemperature Power Adapter\\: {{pcs1_pwm_dallas_24_36v_case_temperature}} °C\nTemperature Kinematics Controller\\: {{pcs1_kin_dallas_4_temperature}} °C\n\n*LED Panel*\nTemperature 40mm Fans\\: {{pcs1_led_panel_fan_140mm_average_temperature}} °C\nTemperature 80mm Fans\\: {{pcs1_led_panel_fan_80mm_average_temperature}} °C\nTemperature average\\: {{pcs1_led_panel_average_temperature}} °C\nTemperature max\\: {{pcs1_led_panel_average_max_temperature}} °C\n\n*Growth Chamber*\nTemperature\\: {{pcs1_growth_chamber_average_humidity}} °C\nHumidity\\: {{pcs1_growth_chamber_average_temperature}} \\%\nIlluminance\\: {{pcs1_growth_chamber_average_illuminance}} lx\nIlluminance max\\: {{pcs1_growth_chamber_average_max_illuminance}} lx\n\n*Water tank*\nTemperature\\: {{pcs1_as_rtd}} °C\nPH\\-Value\\: {{pcs1_as_ph}}\nConductivity\\: {{pcs1_as_ec}} μS\\/cm\n\n*Kinematics*\nGlobal angle\\: {{pcs1_kin_stepper_angle}}\nPlant gear angle\\: {{pcs1_kin_stepper_plant_gear_rotation_angle}}\nNumber of cycles\\: {{pcs1_kin_stepper_number_of_cycles}}","output":"str","x":1360,"y":1840,"wires":[["cb25d7b6dbc922e1"]]},{"id":"cb25d7b6dbc922e1","type":"function","z":"48c607f195e854e0","name":"function 1","func":"var message = msg.sensor_values;\nmessage = msg.sensor_values.replace(/\\./g, \"\\\\.\");\nmsg.sensor_values = message;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1540,"y":1840,"wires":[["3de2061006ed4f14"]]},{"id":"cf2310f2b0f381a8","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_growth_chamber_average_max_illuminance","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_growth_chamber_average_max_illuminance","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_growth_chamber_average_max_illuminance","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":910,"y":1400,"wires":[["6057264122077205"]]},{"id":"7122fd1877cce70f","type":"comment","z":"48c607f195e854e0","name":"Outside","info":"","x":770,"y":660,"wires":[]},{"id":"aa0f51068fc28f49","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_outside_average_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_outside_average_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_outside_average_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":870,"y":700,"wires":[["399220f5203c7980"]]},{"id":"d7faf1aad28a5a28","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led_panel_fan_140mm_average_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led_panel_fan_140mm_average_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led_panel_fan_140mm_average_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":910,"y":980,"wires":[["255793e369b1496b"]]},{"id":"255793e369b1496b","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led_panel_fan_80mm_average_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led_panel_fan_80mm_average_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led_panel_fan_80mm_average_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":910,"y":1020,"wires":[["3496d20f98c41ee1"]]},{"id":"3496d20f98c41ee1","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led_panel_average_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led_panel_average_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led_panel_average_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":870,"y":1060,"wires":[["24c7e77758c470cc"]]},{"id":"24c7e77758c470cc","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led_panel_average_max_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led_panel_average_max_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led_panel_average_max_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":890,"y":1100,"wires":[["9646d923.432558"]]},{"id":"84e59437bcbfc08b","type":"comment","z":"48c607f195e854e0","name":"Electronics Chamber","info":"","x":810,"y":760,"wires":[]},{"id":"b56ee3cce268f94d","type":"comment","z":"48c607f195e854e0","name":"LED Panel","info":"","x":780,"y":940,"wires":[]},{"id":"399220f5203c7980","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_pwm_dallas_1_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_pwm_dallas_1_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pwm_dallas_1_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":860,"y":800,"wires":[["26b148d692a72133"]]},{"id":"26b148d692a72133","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_pwm_dallas_24_36v_case_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_pwm_dallas_24_36v_case_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pwm_dallas_24_36v_case_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":900,"y":840,"wires":[["5bf6b1d4e81ad3a8"]]},{"id":"5bf6b1d4e81ad3a8","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_kin_dallas_4_temperature","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_dallas_4_temperature","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_dallas_4_temperature","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":850,"y":880,"wires":[["d7faf1aad28a5a28"]]},{"id":"a0c7954da404e8c3","type":"comment","z":"48c607f195e854e0","name":"Growth Chamber","info":"","x":800,"y":1180,"wires":[]},{"id":"c471f0888cca8c0e","type":"comment","z":"48c607f195e854e0","name":"Sensor Data","info":"","x":790,"y":20,"wires":[]},{"id":"5c05af0a8a4570f0","type":"comment","z":"48c607f195e854e0","name":"Water Tank","info":"","x":790,"y":1480,"wires":[]},{"id":"6057264122077205","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_as_ec","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_as_ec","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_as_ec","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":790,"y":1520,"wires":[["975782d5a74649db"]]},{"id":"975782d5a74649db","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_as_rtd","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_as_rtd","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_as_rtd","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":790,"y":1560,"wires":[["05ff8c81ee0f47ac"]]},{"id":"05ff8c81ee0f47ac","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_as_ph","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_as_ph","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_as_ph","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":790,"y":1600,"wires":[["891006cd7ac7ba8f"]]},{"id":"018890c568724ccb","type":"switch","z":"48c607f195e854e0","name":"Choose pcs","property":"originalMessage.text","propertyType":"msg","rules":[{"t":"eq","v":"/sensor_pcs1","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":160,"wires":[["3ceae830466940eb"],["d191939ade03b663"]]},{"id":"d191939ade03b663","type":"function","z":"48c607f195e854e0","name":"help Message","func":"var message = \n`\n*You requested an unknown pcs*\n\nPlease use one of the following commands\\\\:\n\n/help\n/sensor\\\\_pcs1\n`;\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":1900,"wires":[[]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"43d37a1d62b4af3b","type":"comment","z":"48c607f195e854e0","name":"Kinematics","info":"","x":780,"y":1660,"wires":[]},{"id":"891006cd7ac7ba8f","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_kin_stepper_angle","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_angle","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_angle","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":830,"y":1700,"wires":[["b40e4fc8f3b12f56"]]},{"id":"b40e4fc8f3b12f56","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_kin_stepper_plant_gear_rotation_angle","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_plant_gear_rotation_angle","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_plant_gear_rotation_angle","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":900,"y":1760,"wires":[["b50b677a321f8d6d"]]},{"id":"b50b677a321f8d6d","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_kin_stepper_number_of_cycles","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_number_of_cycles","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_number_of_cycles","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":870,"y":1820,"wires":[["67634f6c.20eb7"]]},{"id":"9b0a8bb86f86125b","type":"comment","z":"48c607f195e854e0","name":"Power Consumption","info":"","x":810,"y":60,"wires":[]},{"id":"3ceae830466940eb","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_main_energy","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_main_energy","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_main_energy","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":810,"y":100,"wires":[["fdca3086bda2f08a"]]},{"id":"fdca3086bda2f08a","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_main_power","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_main_power","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_main_power","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":810,"y":140,"wires":[["e4fea31dda5643c3"]]},{"id":"e4fea31dda5643c3","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_kin_current","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_current","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_current","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":810,"y":200,"wires":[["b5b40872f9c4ce09"]]},{"id":"b5b40872f9c4ce09","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led1_hall_a_current","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led1_hall_a_current","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_hall_a_current","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":840,"y":240,"wires":[["68550ecd816985ae"]]},{"id":"68550ecd816985ae","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led1_hall_b_current","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led1_hall_b_current","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_hall_b_current","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":840,"y":280,"wires":[["525bdf6494cf68fd"]]},{"id":"525bdf6494cf68fd","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led2_hall_a_current","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led2_hall_a_current","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_hall_a_current","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":840,"y":320,"wires":[["01169e331fa405f6"]]},{"id":"01169e331fa405f6","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led2_hall_b_current","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led2_hall_b_current","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_hall_b_current","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":840,"y":360,"wires":[["454b25b6b299e89f"]]},{"id":"454b25b6b299e89f","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led3_hall_a_current","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led3_hall_a_current","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led3_hall_a_current","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":840,"y":400,"wires":[["389b969f6860a24a"]]},{"id":"389b969f6860a24a","type":"api-current-state","z":"48c607f195e854e0","name":"pcs1_led4_hall_a_current","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_led4_hall_a_current","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led4_hall_a_current","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":840,"y":440,"wires":[["aa0f51068fc28f49"]]},{"id":"72a8df5fb02f3ea0","type":"comment","z":"b23737722e71b01c","name":"System Status Configuration","info":"","x":220,"y":40,"wires":[]},{"id":"f8c87ef3aa821af7","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_as_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_as_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_as_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":940,"y":140,"wires":[["7afd7503bf8ca145"]]},{"id":"e5275f00efd0cfaf","type":"function","z":"b23737722e71b01c","name":"send message","func":"var message = msg.sensor_values;\nmsg.payload = msg.telegram_message;\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2820,"y":1120,"wires":[[]]},{"id":"881a86438872492c","type":"template","z":"b23737722e71b01c","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System 1 \\- LED Controller status__*\n*PWM*\na\\_1\\_white\\: {{pcs1_pwm_cc_a_1_white}}\na\\_2\\_white\\: {{pcs1_pwm_cc_a_2_white}}\na\\_3\\_520nm\\: {{pcs1_pwm_cc_a_3_520nm}}\na\\_4\\_fan\\: {{pcs1_pwm_cc_a_4_fan}}\n\n*LED1*\na\\_1\\_730nm\\: {{pcs1_led1_cc_a_1_730nm}}\na\\_2\\_730nm\\: {{pcs1_led1_cc_a_2_730nm}}\na\\_3\\_730nm\\: {{pcs1_led1_cc_a_3_730nm}}\na\\_4\\_730nm\\: {{pcs1_led1_cc_a_4_730nm}}\nb\\_1\\_660nm\\: {{pcs1_led1_cc_b_1_660nm}}\nb\\_2\\_660nm\\: {{pcs1_led1_cc_b_2_660nm}}\nb\\_3\\_660nm\\: {{pcs1_led1_cc_b_3_660nm}}\nb\\_4\\_660nm\\: {{pcs1_led1_cc_b_4_660nm}}\n\n*LED2*\na\\_1\\_630nm\\: {{pcs1_led2_cc_a_1_630nm}}\na\\_2\\_630nm\\: {{pcs1_led2_cc_a_2_630nm}}\na\\_3\\_630nm\\: {{pcs1_led2_cc_a_3_630nm}}\na\\_4\\_630nm\\: {{pcs1_led2_cc_a_4_630nm}}\nb\\_1\\_630nm\\: {{pcs1_led2_cc_b_1_630nm}}\nb\\_2\\_630nm\\: {{pcs1_led2_cc_b_2_630nm}}\nb\\_3\\_630nm\\: {{pcs1_led2_cc_b_3_630nm}}\nb\\_4\\_630nm\\: {{pcs1_led2_cc_b_4_630nm}}\n\n*LED3*\na\\_1\\_butterfly\\: {{pcs1_led3_cc_a_1_butterfly}}\na\\_2\\_butterfly\\: {{pcs1_led3_cc_a_2_butterfly}}\na\\_3\\_butterfly\\: {{pcs1_led3_cc_a_3_butterfly}}\na\\_4\\_butterfly\\: {{pcs1_led3_cc_a_4_butterfly}}\n\n*LED4*\na\\_1\\_450nm:\\ {{pcs1_led4_cc_a_1_450nm}}\na\\_2\\_450nm:\\ {{pcs1_led4_cc_a_2_450nm}}\na\\_3\\_450nm:\\ {{pcs1_led4_cc_a_3_450nm}}\na\\_4\\_450nm:\\ {{pcs1_led4_cc_a_4_450nm}}","output":"str","x":2500,"y":820,"wires":[["152a4222d2bce967"]]},{"id":"152a4222d2bce967","type":"function","z":"b23737722e71b01c","name":"function 3","func":"var message = msg.sensor_values;\nmessage = msg.sensor_values.replace(/\\./g, \"\\\\.\");\nmsg.sensor_values = message;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2620,"y":1120,"wires":[["e5275f00efd0cfaf"]]},{"id":"b74175a2fa057431","type":"comment","z":"b23737722e71b01c","name":"ESP32 Controller Status","info":"","x":950,"y":40,"wires":[]},{"id":"7afd7503bf8ca145","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_cam1_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_cam1_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_cam1_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":180,"wires":[["e045093fefc93dca"]]},{"id":"e045093fefc93dca","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_cam2_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_cam2_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_cam2_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":240,"wires":[["7c01163c6a83e849"]]},{"id":"7c01163c6a83e849","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_cam3_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_cam3_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_cam3_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":300,"wires":[["a00ad433ee1ea283"]]},{"id":"a00ad433ee1ea283","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_cam4_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_cam4_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_cam4_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":360,"wires":[["0a5d0c5da909c688"]]},{"id":"0a5d0c5da909c688","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_cam5_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_cam5_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_cam5_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":420,"wires":[["c8702b07db1d3c3e"]]},{"id":"c8702b07db1d3c3e","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_cam6_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_cam6_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_cam6_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":480,"wires":[["2b36ea13537740e5"]]},{"id":"2b36ea13537740e5","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_cam7_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_cam7_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_cam7_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":540,"wires":[["b77f22f93f10cb1e"]]},{"id":"b77f22f93f10cb1e","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_kin_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_kin_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":940,"y":600,"wires":[["b22beb6f05c3a661"]]},{"id":"b22beb6f05c3a661","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_led1_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":660,"wires":[["44ddf8c700f40ee8"]]},{"id":"44ddf8c700f40ee8","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_led2_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":720,"wires":[["14aec7576e8539c0"]]},{"id":"14aec7576e8539c0","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led3_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_led3_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led3_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":780,"wires":[["9c230bbff29ce4ea"]]},{"id":"9c230bbff29ce4ea","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led4_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_led4_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led4_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":840,"wires":[["5d0afa210f0be3f0"]]},{"id":"5d0afa210f0be3f0","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pwm_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_pwm_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pwm_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":900,"wires":[["4ef2e39e2cd33dc6"]]},{"id":"4ef2e39e2cd33dc6","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pump_status","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_pump_status","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pump_status","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":950,"y":960,"wires":[["f02d8f9b8988ab78"]]},{"id":"153873dda9f64306","type":"comment","z":"b23737722e71b01c","name":"Kinematics","info":"","x":1180,"y":40,"wires":[]},{"id":"5811ea34ca5ee164","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_kin_stepper_enable_motor","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.pcs1_kin_stepper_enable_motor","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_enable_motor","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1260,"y":100,"wires":[["7c3ba36551a36228"]]},{"id":"7c3ba36551a36228","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_kin_stepper_active","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_kin_stepper_active","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_active","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1250,"y":160,"wires":[["f1998a10e4cdc169"]]},{"id":"f1998a10e4cdc169","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_kin_stepper_homing_is_valid","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.pcs1_kin_stepper_homing_is_valid","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_homing_is_valid","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1280,"y":240,"wires":[["52c4b87b77859cda"]]},{"id":"52c4b87b77859cda","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_kin_stepper_error_code","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_error_code","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_error_code","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1250,"y":320,"wires":[["0499d1bca1436586"]]},{"id":"0499d1bca1436586","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_kin_stepper_mode","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_mode","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1230,"y":380,"wires":[["83561b399977f5a6"]]},{"id":"83561b399977f5a6","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_kin_stepper_automation_mode","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_automation_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_kin_stepper_automation_mode","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1290,"y":440,"wires":[["c69a392ae851be7f"]]},{"id":"769f129cb07ace1f","type":"comment","z":"b23737722e71b01c","name":"Pump","info":"","x":1550,"y":40,"wires":[]},{"id":"50bc2749f483f63e","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pump_enable","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.pcs1_pump_enable","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pump_enable","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1580,"y":100,"wires":[["b2fc09ef13bfd14e"]]},{"id":"b2fc09ef13bfd14e","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pump_automation","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.pcs1_pump_automation","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pump_automation","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1590,"y":160,"wires":[["36aaaf2d060a1438"]]},{"id":"ab1ccc685c069072","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pwm_cc_a_1_white","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_pwm_cc_a_1_white","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pwm_cc_a_1_white","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1870,"y":140,"wires":[["5a010915a6be5c46"]]},{"id":"a8c1d151c79ea68e","type":"comment","z":"b23737722e71b01c","name":"LED","info":"","x":1810,"y":40,"wires":[]},{"id":"5a010915a6be5c46","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pwm_cc_a_2_white","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_pwm_cc_a_2_white","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pwm_cc_a_2_white","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1870,"y":200,"wires":[["6a3c27c258c14fab"]]},{"id":"6a3c27c258c14fab","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pwm_cc_a_3_520nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_pwm_cc_a_3_520nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pwm_cc_a_3_520nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":260,"wires":[["29cad3a1d6e9a4b3"]]},{"id":"2f0af38a67194f50","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_pwm_cc_a_4_fan","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"fan.pcs1_pwm_cc_a_4_fan","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_pwm_cc_a_4_fan","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1870,"y":80,"wires":[["ab1ccc685c069072"]]},{"id":"29cad3a1d6e9a4b3","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_a_1_730nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_a_1_730nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_a_1_730nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":340,"wires":[["d634c4df28bf5f75"]]},{"id":"d634c4df28bf5f75","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_a_2_730nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_a_2_730nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_a_2_730nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":400,"wires":[["6b2f6fde979c017c"]]},{"id":"6b2f6fde979c017c","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_a_3_730nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_a_3_730nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_a_3_730nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":460,"wires":[["a76abff7869e15e8"]]},{"id":"a76abff7869e15e8","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_a_4_730nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_a_4_730nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_a_4_730nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":520,"wires":[["37d1583516db21b9"]]},{"id":"37d1583516db21b9","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_b_1_660nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_b_1_660nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_b_1_660nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":580,"wires":[["80afbb36b25b1015"]]},{"id":"80afbb36b25b1015","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_b_2_660nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_b_2_660nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_b_2_660nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":640,"wires":[["7a1595c531c6e47b"]]},{"id":"7a1595c531c6e47b","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_b_3_660nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_b_3_660nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_b_3_660nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":700,"wires":[["2e297c6f5a5d9691"]]},{"id":"2e297c6f5a5d9691","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led1_cc_b_4_660nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led1_cc_b_4_660nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led1_cc_b_4_660nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1880,"y":760,"wires":[["ca13e84c7c7e6acb"]]},{"id":"15c51c2042b7ed22","type":"switch","z":"b23737722e71b01c","name":"Choose Info","property":"originalMessage.text","propertyType":"msg","rules":[{"t":"eq","v":"/status_pcs1_controller","vt":"str"},{"t":"eq","v":"/status_pcs1_kinematics","vt":"str"},{"t":"eq","v":"/status_pcs1_pump","vt":"str"},{"t":"eq","v":"/status_pcs1_led","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":5,"x":370,"y":100,"wires":[["8c04d4bd8e0a32f6"],["5811ea34ca5ee164"],["50bc2749f483f63e"],["2f0af38a67194f50"],["875d78b4cd8d2901"]]},{"id":"f02d8f9b8988ab78","type":"template","z":"b23737722e71b01c","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System 1 \\- Device Information__*\n\nMain Power Supply\\: {{pcs1_main}}\nAtlas Scientific\\: {{pcs1_as_status}}\nCam 1\\: {{pcs1_cam1_status}}\nCam 2\\: {{pcs1_cam2_status}}\nCam 3\\: {{pcs1_cam3_status}}\nCam 4\\: {{pcs1_cam4_status}}\nCam 5\\: {{pcs1_cam5_status}}\nCam 6\\: {{pcs1_cam6_status}}\nCam 7\\: {{pcs1_cam7_status}}\nKinematics\\: {{pcs1_kin_status}}\nLED 1\\: {{pcs1_led1_status}}\nLED 2\\: {{pcs1_led2_status}}\nLED 3\\: {{pcs1_led3_status}}\nLED 4\\: {{pcs1_led4_status}}\nPWM\\: {{pcs1_pwm_status}}\nPump\\: {{pcs1_pump_status}}","output":"str","x":920,"y":1040,"wires":[["152a4222d2bce967"]]},{"id":"875d78b4cd8d2901","type":"function","z":"b23737722e71b01c","name":"help Message","func":"var message = \n`\n*Choose one of the following options\\\\:*\n\n/help\n/status\\\\_pcs1\\\\_controller\n/status\\\\_pcs1\\\\_kinematics\n/status\\\\_pcs1\\\\_pump\n/status\\\\_pcs1\\\\_led\n`;\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":1240,"wires":[["ebcd808e34d04051"]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"c69a392ae851be7f","type":"template","z":"b23737722e71b01c","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System 1 \\- Kinematics status__*\n\nMotor enabled\\: {{pcs1_kin_stepper_enable_motor}}\nMotor active\\: {{pcs1_kin_stepper_active}}\nHoming is valied\\: {{pcs1_kin_stepper_homing_is_valid}}\nError code\\: {{pcs1_kin_stepper_error_code}}\nMode\\: {{pcs1_kin_stepper_mode}}\nAutomation mode\\: {{pcs1_kin_stepper_automation_mode}}\n","output":"str","x":1220,"y":920,"wires":[["152a4222d2bce967"]]},{"id":"36aaaf2d060a1438","type":"template","z":"b23737722e71b01c","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System 1 \\- Pump status__*\n\nPump enabled\\: {{pcs1_pump_enable}}\nPump Automation active\\: {{pcs1_pump_automation}}","output":"str","x":1540,"y":760,"wires":[["152a4222d2bce967"]]},{"id":"ca13e84c7c7e6acb","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_a_1_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_a_1_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_a_1_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":80,"wires":[["ebae3f762fce07e9"]]},{"id":"ebae3f762fce07e9","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_a_2_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_a_2_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_a_2_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":140,"wires":[["70018be6955d4a0d"]]},{"id":"70018be6955d4a0d","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_a_3_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_a_3_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_a_3_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":200,"wires":[["12d548e1fa0a35eb"]]},{"id":"12d548e1fa0a35eb","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_a_4_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_a_4_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_a_4_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":260,"wires":[["6e570d116e1fe2ba"]]},{"id":"6e570d116e1fe2ba","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_b_1_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_b_1_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_b_1_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":320,"wires":[["100b329fc481e9d4"]]},{"id":"100b329fc481e9d4","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_b_2_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_b_2_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_b_2_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":380,"wires":[["d195ab37cf907380"]]},{"id":"d195ab37cf907380","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_b_3_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_b_3_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_b_3_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":440,"wires":[["2e5001988676f900"]]},{"id":"2e5001988676f900","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led2_cc_b_4_630nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led2_cc_b_4_630nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led2_cc_b_4_630nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":500,"wires":[["c3b001e391db2fec"]]},{"id":"c3b001e391db2fec","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led3_cc_a_1_butterfly","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led3_cc_a_1_butterfly","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led3_cc_a_1_butterfly","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":580,"wires":[["42db4b1bdc50b07d"]]},{"id":"42db4b1bdc50b07d","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led3_cc_a_2_butterfly","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led3_cc_a_2_butterfly","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led3_cc_a_2_butterfly","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":640,"wires":[["5f9bfb665d7d17a7"]]},{"id":"5f9bfb665d7d17a7","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led3_cc_a_3_butterfly","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led3_cc_a_3_butterfly","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led3_cc_a_3_butterfly","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":700,"wires":[["ad5419a574c412bf"]]},{"id":"ad5419a574c412bf","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led3_cc_a_4_butterfly","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led3_cc_a_4_butterfly","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led3_cc_a_4_butterfly","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2180,"y":760,"wires":[["02a6f6b02c2698ac"]]},{"id":"02a6f6b02c2698ac","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led4_cc_a_1_450nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led4_cc_a_1_450nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led4_cc_a_1_450nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2500,"y":80,"wires":[["c7c24817f954fae3"]]},{"id":"c7c24817f954fae3","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led4_cc_a_2_450nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led4_cc_a_2_450nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led4_cc_a_2_450nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2500,"y":140,"wires":[["4f057f6525ecfb1a"]]},{"id":"4f057f6525ecfb1a","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led4_cc_a_3_450nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led4_cc_a_3_450nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led4_cc_a_3_450nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2500,"y":200,"wires":[["f45306ad8cb4f88b"]]},{"id":"f45306ad8cb4f88b","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_led4_cc_a_4_450nm","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.pcs1_led4_cc_a_4_450nm","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_led4_cc_a_4_450nm","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":2500,"y":260,"wires":[["881a86438872492c"]]},{"id":"6d684a72239c0dab","type":"template","z":"b23737722e71b01c","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System 1 \\- Node status__*\n\nMain Power Controller\\: {{pcs1_main}}\nAtlas Scientific\\: {{pcs1_as_status}}\nCam 1\\: {{pcs1_cam1_status}}\nCam 2\\: {{pcs1_cam2_status}}\nCam 3\\: {{pcs1_cam3_status}}\nCam 4\\: {{pcs1_cam4_status}}\nCam 5\\: {{pcs1_cam5_status}}\nCam 6\\: {{pcs1_cam6_status}}\nCam 7\\: {{pcs1_cam7_status}}\nKinematics\\: {{pcs1_kin_status}}\nLED 1\\: {{pcs1_led1_status}}\nLED 2\\: {{pcs1_led2_status}}\nLED 3\\: {{pcs1_led3_status}}\nLED 4\\: {{pcs1_led4_status}}\nPWM\\: {{pcs1_pwm_status}}\nPump\\: {{pcs1_pump_status}}","output":"str","x":920,"y":1140,"wires":[["152a4222d2bce967"]]},{"id":"8c04d4bd8e0a32f6","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_main","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.pcs1_main","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_main","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":930,"y":80,"wires":[["f8c87ef3aa821af7"]]},{"id":"ebcd808e34d04051","type":"api-current-state","z":"b23737722e71b01c","name":"pcs1_main","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.pcs1_main","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_main","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":1110,"y":1240,"wires":[["aaaddc516de66bf6"]]},{"id":"aaaddc516de66bf6","type":"template","z":"b23737722e71b01c","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System status__*\nHome Assistant\\: running\nMain Power Supply PCS1\\: {{pcs1_main}} \n\n*more status information\\:*\n/help\n/status\\_pcs1\\_controller\n/status\\_pcs1\\_kinematics\n/status\\_pcs1\\_pump\n/status\\_pcs1\\_led\n\n","output":"str","x":1280,"y":1240,"wires":[["ec849a4fdf9ebba6"]]},{"id":"ec849a4fdf9ebba6","type":"function","z":"b23737722e71b01c","name":"escapes","func":"var message = msg.sensor_values;\nmessage = msg.sensor_values.replace(/\\./g, \"\\\\.\");\nmsg.sensor_values = message;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1460,"y":1240,"wires":[["5ce807b09bcd0106"]]},{"id":"5ce807b09bcd0106","type":"function","z":"b23737722e71b01c","name":"send message","func":"var message = msg.sensor_values;\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1660,"y":1240,"wires":[[]]},{"id":"4611608905aa7003","type":"switch","z":"9e7ca1741a410453","name":"Choose Node","property":"originalMessage.text","propertyType":"msg","rules":[{"t":"eq","v":"/restart_pcs1_main","vt":"str"},{"t":"eq","v":"/restart_pcs1_as","vt":"str"},{"t":"eq","v":"/restart_pcs1_cam1","vt":"str"},{"t":"eq","v":"/restart_pcs1_cam2","vt":"str"},{"t":"eq","v":"/restart_pcs1_cam3","vt":"str"},{"t":"eq","v":"/restart_pcs1_cam4","vt":"str"},{"t":"eq","v":"/restart pcs1_cam5","vt":"str"},{"t":"eq","v":"/restart_pcs1_cam6","vt":"str"},{"t":"eq","v":"/restart_pcs1_cam7","vt":"str"},{"t":"eq","v":"/restart_pcs1_kin","vt":"str"},{"t":"eq","v":"/restart_pcs1_led1","vt":"str"},{"t":"eq","v":"/restart_pcs1_led2","vt":"str"},{"t":"eq","v":"/restart_pcs1_led3","vt":"str"},{"t":"eq","v":"/restart_pcs1_led4","vt":"str"},{"t":"eq","v":"/restart_pcs1_pwm","vt":"str"},{"t":"eq","v":"/restart_pcs1_pump","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":17,"x":260,"y":200,"wires":[["2fcaf9799534b1d7"],["63198af7d6e9f922"],["5d1428569352a6a2"],["8cedf61717a61053"],["ceb33822dab89e99"],["d839b769a5aed58b"],["46032d37bce9325e"],["2d5f7be417f45550"],["66564d475fa51178"],["d69ee6732612dba9"],["83f4f5769bdda618"],["8a7fdda2df849baf"],["be0ec3d81bd6fd5c"],["5ed0d6831505bf67"],["41423d8bd0a419e7"],["eb6c6024d3ae47bc"],["a0b78b93d8cee4bb"]]},{"id":"fa077b5ba0aa76da","type":"comment","z":"9e7ca1741a410453","name":"Reboot","info":"","x":90,"y":40,"wires":[]},{"id":"5d1428569352a6a2","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_cam1_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_cam1_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":160,"wires":[["9870875b85e30781"]]},{"id":"8cedf61717a61053","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_cam2_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_cam2_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":220,"wires":[["9870875b85e30781"]]},{"id":"ceb33822dab89e99","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_cam3_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_cam3_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":280,"wires":[["9870875b85e30781"]]},{"id":"d839b769a5aed58b","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_cam4_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_cam4_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":340,"wires":[["9870875b85e30781"]]},{"id":"46032d37bce9325e","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_cam5_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_cam5_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":400,"wires":[["9870875b85e30781"]]},{"id":"2d5f7be417f45550","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_cam6_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_cam6_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":460,"wires":[["9870875b85e30781"]]},{"id":"66564d475fa51178","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_cam7_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_cam7_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":520,"wires":[["9870875b85e30781"]]},{"id":"a0b78b93d8cee4bb","type":"function","z":"9e7ca1741a410453","name":"help Message","func":"var message = \n`\n*You requested an unknown pcs*\n\nPlease use one of the following commands\\\\:\n\n/help\n/restart\\\\_pcs1\\\\_main\n/restart\\\\_pcs1\\\\_as\n/restart\\\\_pcs1\\\\_cam1\n/restart\\\\_pcs1\\\\_cam2\n/restart\\\\_pcs1\\\\_cam3\n/restart\\\\_pcs1\\\\_cam4\n/restart\\\\_pcs1\\\\_cam5\n/restart\\\\_pcs1\\\\_cam6\n/restart\\\\_pcs1\\\\_cam7\n/restart\\\\_pcs1\\\\_kin\n/restart\\\\_pcs1\\\\_led1\n/restart\\\\_pcs1\\\\_led2\n/restart\\\\_pcs1\\\\_led3\n/restart\\\\_pcs1\\\\_led4\n/restart\\\\_pcs1\\\\_pwm\n/restart\\\\_pcs1\\\\_pump\n`;\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":1060,"wires":[[]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"63198af7d6e9f922","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_as_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_as_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":100,"wires":[["9870875b85e30781"]]},{"id":"d69ee6732612dba9","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_kin_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_kin_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":580,"wires":[["9870875b85e30781"]]},{"id":"83f4f5769bdda618","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_led1_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_led1_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":640,"wires":[["9870875b85e30781"]]},{"id":"8a7fdda2df849baf","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_led2_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_led2_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":700,"wires":[["9870875b85e30781"]]},{"id":"be0ec3d81bd6fd5c","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_led3_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_led3_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":760,"wires":[["9870875b85e30781"]]},{"id":"5ed0d6831505bf67","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_led4_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_led4_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":820,"wires":[["9870875b85e30781"]]},{"id":"eb6c6024d3ae47bc","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_pump_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_pump_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":700,"y":940,"wires":[["9870875b85e30781"]]},{"id":"41423d8bd0a419e7","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_pwm_restart","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_pwm_restart","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":880,"wires":[["9870875b85e30781"]]},{"id":"9870875b85e30781","type":"function","z":"9e7ca1741a410453","name":"restarting message","func":"var message = \n`\nRestarting node\n`;\n\nmsg.payload = msg.telegram_message;\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1080,"y":160,"wires":[[]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"2fcaf9799534b1d7","type":"api-call-service","z":"9e7ca1741a410453","name":"pcs1_main","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.pcs1_main_reboot","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":670,"y":40,"wires":[["9870875b85e30781"]]},{"id":"922a8d6a1d97d0ef","type":"switch","z":"ca65c1dbac21ab41","name":"Choose Node","property":"originalMessage.text","propertyType":"msg","rules":[{"t":"eq","v":"/power_pcs1_on","vt":"str"},{"t":"eq","v":"/power_pcs1_off","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":240,"y":200,"wires":[["2c7e4612f0474c19"],["5f424f059ad6c9f6"],["78872f6d664a1dc4"]]},{"id":"78872f6d664a1dc4","type":"function","z":"ca65c1dbac21ab41","name":"help Message","func":"var message = \n`\n*You requested an unknown command*\n\nPlease use one of the following commands\\\\:\n\n/power\\\\_pcs1\\\\_on\n/power\\\\_pcs1\\\\_off\n/help\n`;\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":280,"wires":[[]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"2c7e4612f0474c19","type":"api-call-service","z":"ca65c1dbac21ab41","name":"PCS1 On","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.pcs1_main","data":"on","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":440,"y":140,"wires":[["995a79c0d062cc28"]]},{"id":"5f424f059ad6c9f6","type":"api-call-service","z":"ca65c1dbac21ab41","name":"PCS1 Off","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.pcs1_main","data":"off","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":440,"y":180,"wires":[["117dd8d8bf3522f8"]]},{"id":"995a79c0d062cc28","type":"function","z":"ca65c1dbac21ab41","name":"","func":"var message = \n`\nTurning on PCS1\n`;\n\nmsg.payload = msg.telegram_message;\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":660,"y":120,"wires":[[]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"117dd8d8bf3522f8","type":"function","z":"ca65c1dbac21ab41","name":"","func":"var message = \n`\nTurning off PCS1\n`;\n\nmsg.payload = msg.telegram_message;\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":660,"y":180,"wires":[[]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"84751c5bb01f818c","type":"api-current-state","z":"6c80f1ca0dd2938f","name":"plant","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.{{pcs}}_kin_stepper_{{cam}}_plant","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"plant","propertyType":"msg","value":"","valueType":"entityState"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":210,"y":160,"wires":[["7983922acada6878"]]},{"id":"7983922acada6878","type":"function","z":"6c80f1ca0dd2938f","name":"function 13","func":"var plant = parseInt(msg.plant, 10);\nvar plant_string = \"plant\" + plant.toString();\nmsg.plant = plant_string;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":160,"wires":[[]]},{"id":"fce9674ba66a1bd7","type":"function","z":"d2fb9f710e7a6826","name":"function 20","func":"var angle = parseFloat(msg.global_angle);\nvar result = 0;\n\nif (angle >= 0.0 &&\n          angle < 30.0)\n{\n    result = 0;\n}else if (angle >= 30.0 &&\n          angle < 90.0) \n{\n    result = 200;\n}else if (angle >= 90.0 &&\n          angle < 150.0) \n{\n    result = 40;\n}else if (angle >= 150.0 &&\n          angle < 210.0) \n{\n    result = 240;\n}else if (angle >= 210.0 &&\n          angle < 270.0) \n{\n    result = 80;\n}else if (angle >= 270.0 &&\n           angle < 330.0) \n{\n    result = 280;\n}else if (angle >= 330.0 &&\n          angle < 390.0) \n{\n    result = 120;\n}else if (angle >= 390.0 &&\n          angle < 450.0) \n{\n    result = 320;\n}else if (angle >= 450.0 &&\n          angle < 510.0) \n{\n    result = 160;\n} else if (angle >= 510.0 &&\n           angle < 570.0) \n{\n    result = 0;\n}\nelse if (angle >= 570.0 &&\n    angle < 630.0) {\n    result = 200;\n} else if (angle >= 630.0 &&\n    angle < 690.0) {\n    result = 40;\n} else if (angle >= 690.0 &&\n    angle < 750.0) {\n    result = 240;\n} else if (angle >= 750.0 &&\n    angle < 810.0) {\n    result = 80;\n} else if (angle >= 810.0 &&\n    angle < 870.0) {\n    result = 280;\n} else if (angle >= 870.0 &&\n    angle < 930.0) {\n    result = 120;\n} else if (angle >= 930.0 &&\n    angle < 990.0) {\n    result = 320;\n} else if (angle >= 990.0 &&\n    angle < 1050.0) {\n    result = 160;\n} else if (angle >= 1050.0 &&\n    angle < 1080.0) {\n    result = 0;\n}\n\nvar result_string = \"angle\" + result.toString();\n\nmsg.angle = result_string;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":810,"y":40,"wires":[["3070e3c89ed7402b"]]},{"id":"5237d65b65725854","type":"api-current-state","z":"d2fb9f710e7a6826","name":"global_angle","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.{{pcs}}_kin_stepper_angle","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"global_angle","propertyType":"msg","value":"","valueType":"entityState"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":410,"y":40,"wires":[["ee1d13637150e409"]]},{"id":"3070e3c89ed7402b","type":"function","z":"d2fb9f710e7a6826","name":"function 21","func":"var global_angle = parseInt(msg.global_angle, 10);\nvar global_angle_string = \"globalAngle\" + global_angle.toString();\nmsg.global_angle = global_angle_string;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":40,"wires":[[]]},{"id":"ee1d13637150e409","type":"api-current-state","z":"d2fb9f710e7a6826","name":"plant_gear_angle","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_plant_gear_rotation_angle","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"plant_gear_angle","propertyType":"msg","value":"","valueType":"entityState"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":610,"y":40,"wires":[["fce9674ba66a1bd7"]]},{"id":"886628d2be68f0a7","type":"change","z":"4e99185239cf91b2","name":"path","rules":[{"t":"set","p":"path","pt":"msg","to":"/config/www/photos/","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":140,"wires":[[]]},{"id":"73568eaefee8249e","type":"api-current-state","z":"3ce6ca2f6197961a","name":"homing_valid?","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.{{pcs}}_kin_stepper_homing_is_valid","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":240,"y":160,"wires":[["fdb455407f39d736"]]},{"id":"fdb455407f39d736","type":"switch","z":"3ce6ca2f6197961a","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":450,"y":160,"wires":[[],[]]},{"id":"19c37ec56a0b6d94","type":"switch","z":"d8b948f39935830f","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":60,"wires":[[],[]]},{"id":"c26543d53a9d3aaf","type":"api-current-state","z":"d8b948f39935830f","name":"motor_enabled?","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.{{pcs}}_kin_stepper_enable_motor","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":310,"y":60,"wires":[["19c37ec56a0b6d94"]]},{"id":"781da8795bb615f9","type":"api-current-state","z":"fd625c48e8c8ae90","name":"automation_main_active?","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.{{pcs}}_automation_main_active","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":230,"y":120,"wires":[["e91504ef7f6314bd"]]},{"id":"e91504ef7f6314bd","type":"switch","z":"fd625c48e8c8ae90","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":120,"wires":[[],[]]},{"id":"882565c3c6febbca","type":"api-current-state","z":"53bd181b0b773e57","name":"","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.{{pcs}}_kin_stepper_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"stepper_mode","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":360,"y":260,"wires":[["a932fbf80bfd95fe","88807011f51d9ec0"]]},{"id":"88807011f51d9ec0","type":"switch","z":"53bd181b0b773e57","name":"","property":"stepper_mode","propertyType":"msg","rules":[{"t":"eq","v":"0.0","vt":"str"},{"t":"eq","v":"1.0","vt":"str"},{"t":"eq","v":"2.0","vt":"str"},{"t":"eq","v":"3.0","vt":"str"},{"t":"eq","v":"10.0","vt":"str"},{"t":"eq","v":"11.0","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":7,"x":870,"y":260,"wires":[[],[],[],[],[],[],[]]},{"id":"a932fbf80bfd95fe","type":"function","z":"53bd181b0b773e57","d":true,"name":"function 24","func":"var stepper_mode = parseInt(msg.stepper_mode, 10);\nmsg.stepper_mode = stepper_mode;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":690,"y":340,"wires":[["88807011f51d9ec0"]]},{"id":"88b036a8fe3db20f","type":"switch","z":"2d3973ed11ae3dc8","name":"pcs_number","property":"topic","propertyType":"msg","rules":[{"t":"cont","v":"pcs1","vt":"str"},{"t":"cont","v":"pcs2","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":330,"y":100,"wires":[["e14c14ab4bdfd14d"],["ee57bbb2778ce146"]]},{"id":"e14c14ab4bdfd14d","type":"change","z":"2d3973ed11ae3dc8","name":"pcs1","rules":[{"t":"set","p":"pcs","pt":"msg","to":"pcs1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":60,"wires":[[]]},{"id":"ee57bbb2778ce146","type":"change","z":"2d3973ed11ae3dc8","name":"pcs2","rules":[{"t":"set","p":"pcs","pt":"msg","to":"pcs2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":140,"wires":[[]]},{"id":"4188f9afebc687af","type":"api-current-state","z":"60792d08bd7f197a","name":"automation_kinematics_active","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.{{pcs}}_automation_kinematics_active","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":390,"y":120,"wires":[["e6f58aca0f6eda21"]]},{"id":"e6f58aca0f6eda21","type":"switch","z":"60792d08bd7f197a","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":140,"wires":[[],[]]},{"id":"317f2e2d7f56552a","type":"api-current-state","z":"214e5ec186f9b89b","name":"","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.{{pcs}}_kin_stepper_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":410,"y":200,"wires":[["4aa83709dad5694c"]]},{"id":"4aa83709dad5694c","type":"switch","z":"214e5ec186f9b89b","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":710,"y":200,"wires":[[],[]]},{"id":"e5f8e1f5b3813e67","type":"switch","z":"564c0776b24ee8cb","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":120,"wires":[[],[]]},{"id":"2aa62311bc7126dc","type":"api-current-state","z":"564c0776b24ee8cb","name":"maintenance_mode?","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.{{pcs}}_mode_maintenance_active","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":220,"y":120,"wires":[["e5f8e1f5b3813e67"]]},{"id":"627d1a455e5f15fa","type":"api-current-state","z":"502d9caae1f74190","name":"kin_stepper_start_automation","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.{{pcs}}_kin_stepper_start_automation","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":410,"y":140,"wires":[["7d7f607e55f62188"]]},{"id":"7d7f607e55f62188","type":"switch","z":"502d9caae1f74190","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":140,"wires":[[],[]]},{"id":"1d3cb6856191dcb7","type":"api-current-state","z":"01e96d9e32906378","name":"global_angle","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.{{pcs}}_kin_stepper_angle","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"global_angle","propertyType":"msg","value":"","valueType":"entityState"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":270,"y":140,"wires":[["0ceae42ef2210660"]]},{"id":"0ceae42ef2210660","type":"function","z":"01e96d9e32906378","name":"camera_position","func":"var angle = parseFloat(msg.global_angle);\nvar result = false;\n\nif (angle >= 59.0 &&\n    angle < 61.0) {\n    result = true;\n} else if (angle >= 119.0 &&\n    angle <= 121.0) {\n    result = true;\n} else if (angle >= 179.0 &&\n    angle <= 181.0) {\n    result = true;\n} else if (angle >= 239.0 &&\n    angle <= 241.0) {\n    result = true;\n} else if (angle >= 299.0 &&\n    angle <= 301.0) {\n    result = true;\n} else if (angle >= 359.0 &&\n    angle <= 361.0) {\n    result = true;\n} else if (angle >= 419.0 &&\n    angle <= 421.0) {\n    result = true;\n} else if (angle >= 479.0 &&\n    angle <= 481.0) {\n    result = true;\n} else if (angle >= 539.0 &&\n    angle <= 541.0) {\n    result = true;\n} else if (angle >= 599.0 &&\n    angle <= 601) {\n    result = 0;\n}\nelse if (angle >= 659.0 &&\n    angle <= 661.0) {\n    result = true;\n} else if (angle >= 719.0 &&\n    angle <= 721.0) {\n    result = true;\n} else if (angle >= 779.0 &&\n    angle <= 781.0) {\n    result = true;\n} else if (angle >= 839.0 &&\n    angle <= 841.0) {\n    result = true;\n} else if (angle >= 899.0 &&\n    angle <= 901.0) {\n    result = true;\n} else if (angle >= 959.0 &&\n    angle <= 961.0) {\n    result = true;\n} else if (angle >= 1019.0 &&\n    angle <= 1021.0) {\n    result = true;\n} else if (angle >= 1079.0 &&\n    angle <= 1080.0) {\n    result = true;\n} else if (angle >= 0.0 &&\n    angle <= 1.0) {\n    result = true;\n} else\n{\n    result = false;\n}\n\nmsg.camera_position = result;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":140,"wires":[["496782f254f96c97"]]},{"id":"496782f254f96c97","type":"function","z":"01e96d9e32906378","name":"number_of_turns","func":"var angle = parseFloat(msg.global_angle);\nvar result = false;\n\nif (angle >= 0.0 &&\n    angle < 360) {\n    result = 1;\n} else if (angle >= 360.0 &&\n    angle < 720.0) {\n    result = 2;\n} else if (angle >= 720.0 &&\n    angle <= 1080.0) {\n    result = 3;\n} else{\n    result = 0;\n}\nmsg.number_of_turns = result;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":650,"y":140,"wires":[["b35a0db0090b2484"]]},{"id":"b35a0db0090b2484","type":"function","z":"01e96d9e32906378","name":"local_homing_position","func":"var angle = parseFloat(msg.global_angle);\nvar result = false;\n\nif (angle >= 359.0 &&\n    angle <= 361.0) {\n    result = true;\n} else if (angle >= 719.0 &&\n    angle <= 721.0) {\n    result = true;\n} else if (angle >= 1079.0 &&\n    angle <= 1080.0) {\n    result = true;\n} else if (angle >= 0.0 &&\n    angle <= 1.0)\n{\n    result = true;\n} else{\n    result = false;\n}\nmsg.local_homing_position = result;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":140,"wires":[[]]},{"id":"11eab4e996d21a25","type":"subflow:6c80f1ca0dd2938f","z":"69b5998777ae11cf","name":"","x":420,"y":200,"wires":[["cfe2f9d0dfe3b6c9"]]},{"id":"cfe2f9d0dfe3b6c9","type":"subflow:d2fb9f710e7a6826","z":"69b5998777ae11cf","name":"","x":590,"y":200,"wires":[["2ffbcecb6e53fb32"]]},{"id":"2ffbcecb6e53fb32","type":"api-call-service","z":"69b5998777ae11cf","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":800,"y":200,"wires":[[]]},{"id":"b3dae0b521d9265c","type":"switch","z":"6b9686a43efc2793","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":550,"y":220,"wires":[[],[]]},{"id":"e6f520ae7555c911","type":"api-current-state","z":"6b9686a43efc2793","name":"pictures_taken","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.{{ps}}_pictures_taken","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":350,"y":220,"wires":[["b3dae0b521d9265c"]]},{"id":"a91054ba93a72577","type":"comment","z":"4d69908ddcfaac9c","name":"check homing","info":"","x":630,"y":80,"wires":[]},{"id":"d33504e4987c843b","type":"comment","z":"4d69908ddcfaac9c","name":"check motor enabled","info":"","x":400,"y":80,"wires":[]},{"id":"0d8ec47b90275e42","type":"comment","z":"4d69908ddcfaac9c","name":"starte sequenz","info":"","x":1380,"y":420,"wires":[]},{"id":"65eb403f6358e6a6","type":"comment","z":"4d69908ddcfaac9c","name":"kinematik automation, drehe eine Pflanze weiter","info":"","x":1400,"y":740,"wires":[]},{"id":"ed4741cb1c427cbc","type":"comment","z":"4d69908ddcfaac9c","name":"mache Fotos","info":"","x":1290,"y":660,"wires":[]},{"id":"0df28b32d6d05fa8","type":"comment","z":"4d69908ddcfaac9c","name":"stelle Licht und alles aus","info":"","x":1330,"y":500,"wires":[]},{"id":"d471dccff5543aaa","type":"comment","z":"4d69908ddcfaac9c","name":"weisses Licht an","info":"","x":1310,"y":560,"wires":[]},{"id":"9f21097efb6143d1","type":"comment","z":"4d69908ddcfaac9c","name":"warte","info":"","x":1270,"y":620,"wires":[]},{"id":"c250645db6d00d96","type":"comment","z":"4d69908ddcfaac9c","name":"warte","info":"","x":1270,"y":700,"wires":[]},{"id":"bffbb204ec471778","type":"comment","z":"4d69908ddcfaac9c","name":"schalte Licht ein","info":"","x":860,"y":860,"wires":[]},{"id":"04a8cf8f8cf79072","type":"comment","z":"4d69908ddcfaac9c","name":"Schalte Pumpe ein","info":"","x":1310,"y":780,"wires":[]},{"id":"c842e32bd9335f8b","type":"comment","z":"4d69908ddcfaac9c","name":"lade aktuellen Versuchspfad","info":"","x":1380,"y":460,"wires":[]},{"id":"d4128d2f8e17b033","type":"comment","z":"4d69908ddcfaac9c","name":"timed trigger?","info":"","x":1330,"y":380,"wires":[]},{"id":"25090cc963d87689","type":"comment","z":"4d69908ddcfaac9c","name":"maintenance mode","info":"","x":1670,"y":460,"wires":[]},{"id":"8dfa1d6c21941144","type":"comment","z":"4d69908ddcfaac9c","name":"admin mode","info":"","x":1650,"y":540,"wires":[]},{"id":"ff45781464598a95","type":"comment","z":"4d69908ddcfaac9c","name":"telegram bot","info":"","x":1650,"y":620,"wires":[]},{"id":"16d314750215e554","type":"comment","z":"4d69908ddcfaac9c","name":"Watchdog","info":"","x":1640,"y":680,"wires":[]},{"id":"8996f0ad5be3afca","type":"trigger-state","z":"4d69908ddcfaac9c","d":true,"name":"automation_main","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"input_boolean.pcs1_automation_main_active","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":100,"y":120,"wires":[[],["0bc498545c5bfed5"]]},{"id":"0bc498545c5bfed5","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":170,"y":180,"wires":[["251633a8a883d66b"],[]]},{"id":"2eae561fda2da48e","type":"api-call-service","z":"4d69908ddcfaac9c","name":"automation_main_off","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_off","entityId":"input_boolean.{{pcs}}_automation_main_active","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":400,"y":300,"wires":[[]]},{"id":"5da34bb65134cb2c","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Notification","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"persistent_notification","service":"create","entityId":"","data":"{\"title\":\"Info\",\"message\":\"The motor driver is not enabled.\"}","dataType":"json","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":370,"y":240,"wires":[[]]},{"id":"dbe85980e97111fd","type":"comment","z":"4d69908ddcfaac9c","name":"main Automation turned on","info":"","x":150,"y":80,"wires":[]},{"id":"be5699eae8262704","type":"subflow:3ce6ca2f6197961a","z":"4d69908ddcfaac9c","name":"","x":650,"y":120,"wires":[[],["f5bf6da227d8fd7c"]]},{"id":"0c3c2415a941c6c9","type":"subflow:d8b948f39935830f","z":"4d69908ddcfaac9c","name":"","x":400,"y":120,"wires":[["be5699eae8262704"],["5d0919c9d3075c28"]]},{"id":"c978bd58fb047143","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Homing","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.{{pcs}}_kin_stepper_start_global_homing","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":680,"y":300,"wires":[["fe62be6513b13470"]]},{"id":"cbd81bb84ebfbb56","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Notification","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"persistent_notification","service":"create","entityId":"","data":"{\"title\":\"Info\",\"message\":\"Homing was invalid, started homing process. Waiting for success..\"}","dataType":"json","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":670,"y":240,"wires":[[]]},{"id":"892c3c06315a9491","type":"delay","z":"4d69908ddcfaac9c","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":650,"y":380,"wires":[["897724be3ac92ff0"]]},{"id":"897724be3ac92ff0","type":"api-current-state","z":"4d69908ddcfaac9c","name":"stepper_mode","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.pcs1_kin_stepper_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":880,"y":380,"wires":[["85225a36ec933423"]]},{"id":"85225a36ec933423","type":"switch","z":"4d69908ddcfaac9c","name":"stepper_mode_homing?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":670,"y":460,"wires":[["892c3c06315a9491"],["c10ee2e959ac9a18"]]},{"id":"f233f4bde0f6c0a8","type":"comment","z":"4d69908ddcfaac9c","name":"check if automation was disabled or errors occured","info":"","x":990,"y":80,"wires":[]},{"id":"c10ee2e959ac9a18","type":"subflow:3ce6ca2f6197961a","z":"4d69908ddcfaac9c","name":"","x":900,"y":120,"wires":[[],[]]},{"id":"54fcb3ec.12b7c4","type":"inject","z":"4d69908ddcfaac9c","name":"start","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"0.5","topic":"pcs1","payload":"","payloadType":"date","x":290,"y":600,"wires":[["b037441481dd5b36"]]},{"id":"ec27b93360a73ef3","type":"change","z":"4d69908ddcfaac9c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":420,"wires":[[]]},{"id":"251633a8a883d66b","type":"change","z":"4d69908ddcfaac9c","name":"pcs1","rules":[{"t":"set","p":"pcs","pt":"msg","to":"pcs1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":180,"wires":[["0c3c2415a941c6c9"]]},{"id":"1057178312a186b3","type":"subflow:fd625c48e8c8ae90","z":"4d69908ddcfaac9c","d":true,"name":"","x":740,"y":640,"wires":[["e9bf7bbc616b6da5"],["a0201f4fe3b8d962"]]},{"id":"4382dda014db9fcc","type":"server-state-changed","z":"4d69908ddcfaac9c","d":true,"name":"automation_main_active","server":"f482c16b.7b4d","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"automation_main_active","entityidfiltertype":"substring","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":230,"y":640,"wires":[["b037441481dd5b36"]]},{"id":"3ac1cc3b0063083b","type":"inject","z":"4d69908ddcfaac9c","name":"stop_pcs1","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"3","topic":"pcs1","payload":"","payloadType":"date","x":80,"y":540,"wires":[["91ab32ecc8331355"]]},{"id":"91ab32ecc8331355","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_off","entityId":"input_boolean.pcs1_automation_main_active","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":320,"y":540,"wires":[[]]},{"id":"a0201f4fe3b8d962","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Notification","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"persistent_notification","service":"create","entityId":"","data":"{\"title\":\"Info\",\"message\":\"Main Automation Routine disabled\"}","dataType":"json","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":660,"wires":[[]]},{"id":"e9bf7bbc616b6da5","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Notification","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"persistent_notification","service":"create","entityId":"","data":"{\"title\":\"Info\",\"message\":\"Main Automation Routine Enabled\"}","dataType":"json","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":600,"wires":[[]]},{"id":"c04705e4c9051b67","type":"server-state-changed","z":"4d69908ddcfaac9c","d":true,"name":"automation_kinematics_active","server":"f482c16b.7b4d","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"automation_kinematics_active","entityidfiltertype":"substring","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":190,"y":2340,"wires":[["b4c419d5179dcd46","d4c21afdc9b6cb4b"]]},{"id":"b037441481dd5b36","type":"subflow:2d3973ed11ae3dc8","z":"4d69908ddcfaac9c","name":"","x":480,"y":640,"wires":[["1057178312a186b3"],[]]},{"id":"b4c419d5179dcd46","type":"subflow:2d3973ed11ae3dc8","z":"4d69908ddcfaac9c","name":"","x":520,"y":2340,"wires":[["c3eb715dcc759bcf"],[]]},{"id":"c3eb715dcc759bcf","type":"subflow:60792d08bd7f197a","z":"4d69908ddcfaac9c","name":"","x":740,"y":2320,"wires":[["467a99b003bc56d8"],["1490e17ec963263e"]]},{"id":"e0c8b108ad1f48f3","type":"inject","z":"4d69908ddcfaac9c","d":true,"name":"start_pcs1","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"5","topic":"pcs1","payload":"","payloadType":"date","x":240,"y":2280,"wires":[["b4c419d5179dcd46"]]},{"id":"467a99b003bc56d8","type":"subflow:d8b948f39935830f","z":"4d69908ddcfaac9c","name":"","x":1080,"y":2340,"wires":[["28f43cb0a2157b58"],["f75982897f752997"]]},{"id":"28f43cb0a2157b58","type":"subflow:3ce6ca2f6197961a","z":"4d69908ddcfaac9c","name":"","x":1380,"y":2000,"wires":[["182b0ae1814cc287"],["73ddd19594d50ae8"]]},{"id":"73ddd19594d50ae8","type":"subflow:214e5ec186f9b89b","z":"4d69908ddcfaac9c","name":"","x":1640,"y":2080,"wires":[["b72389383474fcca"],["9d01c540ef4f3b89"]]},{"id":"234c38363391fc91","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Homing","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.{{pcs}}_kin_stepper_start_global_homing","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":860,"y":180,"wires":[[]]},{"id":"9d01c540ef4f3b89","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Homing","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.{{pcs}}_kin_stepper_start_global_homing","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1820,"y":2140,"wires":[["b72389383474fcca"]]},{"id":"29d6bb4216ca8410","type":"comment","z":"4d69908ddcfaac9c","name":"vielleicht hier andere Sachen abschalten","info":"","x":1160,"y":900,"wires":[]},{"id":"f75982897f752997","type":"api-call-service","z":"4d69908ddcfaac9c","d":true,"name":"kinematics_off","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_off","entityId":"input_boolean.{{pcs}}_automation_kinematics_active","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1360,"y":2080,"wires":[[]]},{"id":"0e0dc0344740df42","type":"api-call-service","z":"4d69908ddcfaac9c","name":"stepper_start_automation","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.{{pcs}}_kin_stepper_start_automation","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":4070,"y":2180,"wires":[["45a9bb26a1dd7b8e"]]},{"id":"53c42c7572e04349","type":"subflow:01e96d9e32906378","z":"4d69908ddcfaac9c","name":"","x":1910,"y":1940,"wires":[["5af6a87a7e0455e3"]]},{"id":"5af6a87a7e0455e3","type":"switch","z":"4d69908ddcfaac9c","name":"camera_position?","property":"camera_position","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2140,"y":1940,"wires":[["6ec195159fbb9d9f"],["a7d1b53a034732cb"]]},{"id":"a7d1b53a034732cb","type":"switch","z":"4d69908ddcfaac9c","name":"local_homing_position?","property":"local_homing_position","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2970,"y":2180,"wires":[["f7f9d5664a73e152"],["2fe4e2cd7f18816a"]]},{"id":"f7f9d5664a73e152","type":"api-call-service","z":"4d69908ddcfaac9c","name":"local_homing","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.{{pcs}}_kin_stepper_start_local_homing","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":3190,"y":2140,"wires":[["58e90e552bcf0d82"]]},{"id":"b72389383474fcca","type":"ha-wait-until","z":"4d69908ddcfaac9c","name":"wait_for_homing","server":"f482c16b.7b4d","version":0,"outputs":2,"entityId":"binary_sensor.{{pcs}}_kin_stepper_homing_is_valid","entityIdFilterType":"exact","property":"state","comparator":"is","value":"on","valueType":"str","timeout":"90","timeoutType":"num","timeoutUnits":"minutes","entityLocation":"data","entityLocationType":"none","checkCurrentState":true,"blockInputOverrides":true,"x":1930,"y":2060,"wires":[["28f43cb0a2157b58"],["8a64af7239a5f8b9"]]},{"id":"8a64af7239a5f8b9","type":"api-call-service","z":"4d69908ddcfaac9c","name":"kinematics_off","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_off","entityId":"input_boolean.{{pcs}}_automation_kinematics_active","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":2150,"y":2080,"wires":[[]]},{"id":"1490e17ec963263e","type":"api-call-service","z":"4d69908ddcfaac9c","name":"stop_motor","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.{{pcs}}_kin_stepper_stop","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1030,"y":2280,"wires":[[]]},{"id":"58e90e552bcf0d82","type":"ha-wait-until","z":"4d69908ddcfaac9c","name":"wait_for_homing_finished","server":"f482c16b.7b4d","version":0,"outputs":2,"entityId":"sensor.{{pcs}}_kin_stepper_mode","entityIdFilterType":"exact","property":"state","comparator":"is","value":"1.0","valueType":"str","timeout":"5","timeoutType":"num","timeoutUnits":"minutes","entityLocation":"data","entityLocationType":"none","checkCurrentState":true,"blockInputOverrides":true,"x":3420,"y":2140,"wires":[["906666c14b83216c"],["307e46f6821be0e0","2fe4e2cd7f18816a"]]},{"id":"43fd380bcbb4764a","type":"subflow:53bd181b0b773e57","z":"4d69908ddcfaac9c","name":"","x":2900,"y":2600,"wires":[[],[],[],[],[],[],[]]},{"id":"307e46f6821be0e0","type":"api-call-service","z":"4d69908ddcfaac9c","name":"kinematics_off","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_off","entityId":"input_boolean.{{pcs}}_automation_kinematics_active","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":3660,"y":2260,"wires":[[]]},{"id":"182b0ae1814cc287","type":"trigger","z":"4d69908ddcfaac9c","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-10","extend":false,"overrideDelay":false,"units":"min","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":1690,"y":1940,"wires":[["53c42c7572e04349"]]},{"id":"4e0ed9527b25c0a8","type":"change","z":"4d69908ddcfaac9c","name":"path","rules":[{"t":"set","p":"path","pt":"msg","to":"/config/www/photos/automation/","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2750,"y":1660,"wires":[["a075f60d2ac6cc02"]]},{"id":"a075f60d2ac6cc02","type":"change","z":"4d69908ddcfaac9c","name":"cam1","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":1660,"wires":[["dd826a734c2bf80b"]]},{"id":"f2ddf06995900f67","type":"change","z":"4d69908ddcfaac9c","name":"cam2","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":1720,"wires":[["b691db532bef7228"]]},{"id":"e61e14468ac9bcf1","type":"change","z":"4d69908ddcfaac9c","name":"cam3","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":1780,"wires":[["1455f9f03f1274a2"]]},{"id":"14212a7a8c02d3cf","type":"change","z":"4d69908ddcfaac9c","name":"cam4","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":1840,"wires":[["a9e2acb775b4ba34"]]},{"id":"867d0ffc31ec6f19","type":"change","z":"4d69908ddcfaac9c","name":"cam5","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam5","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":1900,"wires":[["911fa6cbfbdd301d"]]},{"id":"98bfb62756d7a634","type":"change","z":"4d69908ddcfaac9c","name":"cam6","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam6","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":1960,"wires":[["093f54345ca21430"]]},{"id":"6125c10f78cc897b","type":"change","z":"4d69908ddcfaac9c","name":"cam7","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam7","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":2020,"wires":[["e190e46cd7d04dd1"]]},{"id":"a5e065765922bdf3","type":"delay","z":"4d69908ddcfaac9c","name":"5s","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2750,"y":1740,"wires":[["4e0ed9527b25c0a8"]]},{"id":"81735f9638e8bd49","type":"delay","z":"4d69908ddcfaac9c","name":"5s","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2950,"y":2080,"wires":[["a7d1b53a034732cb"]]},{"id":"e190e46cd7d04dd1","type":"subflow:d2fb9f710e7a6826","z":"4d69908ddcfaac9c","name":"","x":3090,"y":2020,"wires":[["449e435a326b320c"]]},{"id":"dd826a734c2bf80b","type":"subflow:6c80f1ca0dd2938f","z":"4d69908ddcfaac9c","name":"","x":3080,"y":1660,"wires":[["db54b3c015b046e6"]]},{"id":"db54b3c015b046e6","type":"subflow:d2fb9f710e7a6826","z":"4d69908ddcfaac9c","name":"","x":3250,"y":1660,"wires":[["3796250037859f57"]]},{"id":"3796250037859f57","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":3460,"y":1660,"wires":[["f2ddf06995900f67"]]},{"id":"b691db532bef7228","type":"subflow:6c80f1ca0dd2938f","z":"4d69908ddcfaac9c","name":"","x":3080,"y":1720,"wires":[["2909220468d0d086"]]},{"id":"2909220468d0d086","type":"subflow:d2fb9f710e7a6826","z":"4d69908ddcfaac9c","name":"","x":3250,"y":1720,"wires":[["fb955ae107663ae5"]]},{"id":"fb955ae107663ae5","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":3460,"y":1720,"wires":[["e61e14468ac9bcf1"]]},{"id":"1455f9f03f1274a2","type":"subflow:6c80f1ca0dd2938f","z":"4d69908ddcfaac9c","name":"","x":3080,"y":1780,"wires":[["bf35e776a37ed2c2"]]},{"id":"bf35e776a37ed2c2","type":"subflow:d2fb9f710e7a6826","z":"4d69908ddcfaac9c","name":"","x":3250,"y":1780,"wires":[["a34f246ec945d2e4"]]},{"id":"a34f246ec945d2e4","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":3460,"y":1780,"wires":[["14212a7a8c02d3cf"]]},{"id":"a9e2acb775b4ba34","type":"subflow:6c80f1ca0dd2938f","z":"4d69908ddcfaac9c","name":"","x":3080,"y":1840,"wires":[["c730ef92a2809dd0"]]},{"id":"c730ef92a2809dd0","type":"subflow:d2fb9f710e7a6826","z":"4d69908ddcfaac9c","name":"","x":3250,"y":1840,"wires":[["726c7c7bb1ee598c"]]},{"id":"726c7c7bb1ee598c","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":3460,"y":1840,"wires":[["867d0ffc31ec6f19"]]},{"id":"911fa6cbfbdd301d","type":"subflow:6c80f1ca0dd2938f","z":"4d69908ddcfaac9c","name":"","x":3080,"y":1900,"wires":[["340abcf32e70deef"]]},{"id":"340abcf32e70deef","type":"subflow:d2fb9f710e7a6826","z":"4d69908ddcfaac9c","name":"","x":3250,"y":1900,"wires":[["b0438fa1f425bd89"]]},{"id":"b0438fa1f425bd89","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":3460,"y":1900,"wires":[["98bfb62756d7a634"]]},{"id":"093f54345ca21430","type":"subflow:6c80f1ca0dd2938f","z":"4d69908ddcfaac9c","name":"","x":3080,"y":1960,"wires":[["a58faddcf55a575e"]]},{"id":"a58faddcf55a575e","type":"subflow:d2fb9f710e7a6826","z":"4d69908ddcfaac9c","name":"","x":3250,"y":1960,"wires":[["99d81a083ab8843e"]]},{"id":"99d81a083ab8843e","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":3460,"y":1960,"wires":[["6125c10f78cc897b"]]},{"id":"449e435a326b320c","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":3460,"y":2020,"wires":[["f1a6e93711ec50e6"]]},{"id":"906666c14b83216c","type":"debug","z":"4d69908ddcfaac9c","name":"debug 14","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3680,"y":2080,"wires":[]},{"id":"2fe4e2cd7f18816a","type":"subflow:502d9caae1f74190","z":"4d69908ddcfaac9c","name":"","x":3760,"y":2180,"wires":[[],["0e0dc0344740df42"]]},{"id":"5d22ff7742484a55","type":"comment","z":"4d69908ddcfaac9c","name":"set flag for photos already taken","info":"","x":2670,"y":1600,"wires":[]},{"id":"d305df76abee2078","type":"comment","z":"4d69908ddcfaac9c","name":"set flag for photos already taken","info":"","x":4350,"y":2140,"wires":[]},{"id":"45a9bb26a1dd7b8e","type":"ha-wait-until","z":"4d69908ddcfaac9c","name":"wait_for_stepper_automation","server":"f482c16b.7b4d","version":0,"outputs":2,"entityId":"switch.{{pcs}}_kin_stepper_start_automation","entityIdFilterType":"exact","property":"state","comparator":"is","value":"1.0","valueType":"str","timeout":"10","timeoutType":"num","timeoutUnits":"minutes","entityLocation":"data","entityLocationType":"none","checkCurrentState":true,"blockInputOverrides":true,"x":4390,"y":2280,"wires":[["5e88ee614252db18"],["91439ed801c4ff9b"]]},{"id":"91439ed801c4ff9b","type":"api-call-service","z":"4d69908ddcfaac9c","name":"kinematics_off","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_off","entityId":"input_boolean.{{pcs}}_automation_kinematics_active","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":4620,"y":2320,"wires":[[]]},{"id":"d4c21afdc9b6cb4b","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1390,"y":1940,"wires":[["182b0ae1814cc287"]]},{"id":"f1a6e93711ec50e6","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_on","entityId":"input_boolean.{{pcs}}_pictures_taken","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":3740,"y":2020,"wires":[["81735f9638e8bd49"]]},{"id":"6ec195159fbb9d9f","type":"subflow:6b9686a43efc2793","z":"4d69908ddcfaac9c","name":"","x":2640,"y":2020,"wires":[["a5e065765922bdf3"],["a7d1b53a034732cb"]]},{"id":"5e88ee614252db18","type":"api-call-service","z":"4d69908ddcfaac9c","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"homeassistant","service":"turn_off","entityId":"input_boolean.{{pcs}}_pictures_taken","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":4660,"y":2220,"wires":[[]]},{"id":"2927fea8ac836b7d","type":"smxstate","z":"4d69908ddcfaac9c","name":"","xstateDefinition":"// Available variables/objects/functions:\n// xstate\n// - .Machine\n// - .interpret\n// - .assign\n// - .send\n// - .sendParent\n// - .spawn\n// - .raise\n// - .actions\n//\n// Common\n// - setInterval, setTimeout, clearInterval, clearTimeout\n// - node.send, node.warn, node.log, node.error\n// - context.get, context.set\n// - flow.get, flow.set\n// - env.get\n// - util\n\nconst { assign } = xstate;\n\n// First define names guards, actions, ...\n\n/**\n * Guards\n */\nconst maxValueReached = (context, event) => {\n  return context.counter >= 10;\n};\n\n/**\n * Actions\n */\nconst incrementCounter = assign({\n  counter: (context, event) => context.counter + 1\n});\n\nconst resetCounter = assign({\n  counter: (context, event) => {\n    // Can send log messages via\n    //  - node.log\n    //  - node.warn\n    //  - node.error\n    //node.warn(\"RESET\");\n\n    // Can send messages to the second outport\n    // Specify an array to send multiple messages\n    // at once\n    //  - node.send(msg)\n    node.send({ payload: \"resetCounter\" });\n    \n    return 0;\n  }\n});\n\n/**\n * Activities\n */\nconst doStuff = () => {\n  // See https://xstate.js.org/docs/guides/activities.html\n  const interval = setInterval(() => {\n    node.send({ payload: 'BEEP' });\n  }, 1000);\n  return () => clearInterval(interval);\n};\n\n/***************************\n // Import shorthands from xstate object\nconst { assign } = xstate;\n\n// First define names guards, actions, ...\n\n/**\n * Guards\n */\nconst bellyFull = (context, event) => {\n  return context.belly >= 100;\n};\n\nconst bellyEmpty = (context, event) => {\n  return context.belly <= 0;\n}\n\nconst bellyNotEmpty = (context, event) => {\n  return context.belly > 0;\n}\n\n/**\n * Actions\n */\nconst updateBelly = assign({\n  belly: (context, ev) => Math.max(\n    Math.min(\n      context.belly + ev.value, 100\n    ), 0)\n});\n\n/**\n * Activities\n */\nconst meow = () => {\n  const interval = setInterval(() => node.send({ payload: \"MEOW!\" }), 2000);\n  return () => clearInterval(interval);\n};\n\n/**\n * Services\n * see https://xstate.js.org/docs/guides/communication.html#invoking-callbacks\n */\nconst eat = (ctx, ev) => (cb) => {\n  const id = setInterval(() => cb({\n    type: 'eaten',\n    value: 5\n  }), 500);\n  return () => clearInterval(id);\n};\n\nconst digest = (ctx, ev) => (cb) => {\n  const id = setInterval(() => cb({\n    type: 'digested',\n    value: -5\n  }), 500);\n  return () => clearInterval(id);\n}\n\n/***************************\n * Main machine definition * \n ***************************/\nreturn {\n  machine: {\n    context: {\n      belly: 0    // Belly state, 100 means full, 0 means empty\n    },\n    initial: 'sleep',\n    states: {\n      sleep: {\n        on: {\n          'wake up': 'meow',\n        }\n      },\n      meow: {\n        invoke: { src: 'digest' },\n        on: {\n          'given toy': { target: 'play', cond: 'belly not empty' },\n          'given food': 'eat',\n          'digested': { actions: 'updateBelly' }\n        },\n        activities: ['meow']\n      },\n      play: {\n        invoke: { src: 'digest' },\n        on: {\n          tired: 'sleep',\n          bored: 'sleep',\n          'digested': { actions: 'updateBelly' },\n          '': { target: 'meow', cond: 'belly empty' }\n        },\n        after: {\n          5000: 'sleep',\n        }\n      },\n      eat: {\n        invoke: { src: 'eat' },\n        on: {\n          '': { target: 'sleep', cond: 'belly full' },\n          'no more food': { target: 'meow' },\n          'eaten': { actions: 'updateBelly' }\n        }\n      }\n    }\n  },\n  // Configuration containing guards, actions, activities, ...\n  // see above\n  config: {\n    guards: { \"belly full\": bellyFull, \"belly not empty\": bellyNotEmpty, \"belly empty\": bellyEmpty },\n    activities: { meow },\n    actions: { updateBelly },\n    services: { eat, digest }\n  }\n}","noerr":0,"x":400,"y":840,"wires":[["8295b6a6d47d397e"],["d19ca8f9da3c6331"]]},{"id":"8295b6a6d47d397e","type":"debug","z":"4d69908ddcfaac9c","name":"State","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":610,"y":780,"wires":[]},{"id":"0f7bc67731f58a30","type":"inject","z":"4d69908ddcfaac9c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"wake up","payload":"","payloadType":"str","x":120,"y":720,"wires":[["2927fea8ac836b7d"]]},{"id":"d19ca8f9da3c6331","type":"debug","z":"4d69908ddcfaac9c","name":"Cat output","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":610,"y":860,"wires":[]},{"id":"c0edf30a5956d153","type":"inject","z":"4d69908ddcfaac9c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"given food","payload":"","payloadType":"str","x":130,"y":780,"wires":[["2927fea8ac836b7d"]]},{"id":"75e725b27edf1e3b","type":"inject","z":"4d69908ddcfaac9c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"no more food","payload":"","payloadType":"str","x":130,"y":840,"wires":[["2927fea8ac836b7d"]]},{"id":"f7dab170b50dce19","type":"inject","z":"4d69908ddcfaac9c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"given toy","payload":"","payloadType":"str","x":140,"y":900,"wires":[["2927fea8ac836b7d"]]},{"id":"b90e919e43290383","type":"inject","z":"4d69908ddcfaac9c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"tired","payload":"","payloadType":"str","x":110,"y":940,"wires":[["2927fea8ac836b7d"]]},{"id":"6c0ef028ef2cd3c4","type":"inject","z":"4d69908ddcfaac9c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"bored","payload":"","payloadType":"str","x":115.66668701171875,"y":991.6666259765625,"wires":[["2927fea8ac836b7d"]]},{"id":"a03d265efa3a0ed4","type":"smxstate","z":"4d69908ddcfaac9c","name":"statemachine_pcs1","xstateDefinition":"// Available variables/objects/functions:\n// xstate\n// - .Machine\n// - .interpret\n// - .assign\n// - .send\n// - .sendParent\n// - .spawn\n// - .raise\n// - .actions\n//\n// Common\n// - setInterval, setTimeout, clearInterval, clearTimeout\n// - node.send, node.warn, node.log, node.error\n// - context.get, context.set\n// - flow.get, flow.set\n// - env.get\n// - util\n\nconst pcs = \"pcs1\";\nconst { assign } = xstate;\nconst {Maschine} = pcs;\n\n\n/***************************\n * Main machine definition * \n ***************************/\nreturn {\n    machine: {\n        id: pcs,\n        context: {\n            maintenance: true,\n            automation: false,\n            automation_kinematics: false,\n            automation_led: false,\n            automation_pump: false,\n            kinematics_motor_enabled: false,\n            kinematics_homing_valid: false,\n            kinematics_stepper_mode: 0,\n            kinematics_homing_started: false\n        },\n        initial: 'main',\n        states: {\n            main: {\n                type: 'parallel',\n                states: {\n                    kinematics: {\n                        initial: 'init',\n                        on: {\n                            MAINTENANCE_ON: {\n                                actions: [assign({ maintenance: true }), 'callKinematicsStopMotor'], \n                                target: '.check_states'\n                            },\n                            MAINTENANCE_OFF: {\n                                actions: [assign({ maintenance: false })],\n                            },\n                            AUTOMATION_ON: {\n                                actions: [assign({ automation: true })],\n                            },\n                            AUTOMATION_OFF: {\n                                actions: [assign({ automation: false }), 'callKinematicsStopMotor'],\n                                target: '.check_states'\n                            },\n                            KINEMATICS_ON: {\n                                actions: [assign({ automation_kinematics: true })],\n                            },\n                            KINEMATICS_OFF: {\n                                actions: [assign({ automation_kinematics: false }), 'callKinematicsStopMotor'],\n                                target: '.check_states'\n                            },\n                            KINEMATICS_MOTOR_ENABLED_ON: {\n                                actions: [assign({ kinematics_motor_enabled: true })],\n                            },\n                            KINEMATICS_MOTOR_ENABLED_OFF: {\n                                actions: [assign({ kinematics_motor_enabled: false }), 'callKinematicsStopMotor'],\n                                target: '.check_states'\n                            },\n                        },\n                        states: {\n                            init: {\n                                after: {\n                                    1000: { target: 'check_states' }\n                                },\n                            },\n\n                            check_states: {\n                                entry: ['getMaintenanceState', 'getAutomationState', 'getKinematicsState', 'getKinematicsMotorState'],\n                                after: {\n                                    1000: { target: 'check_states' }\n                                },\n                                always: [\n                                    { target: 'running', cond: (context, event) => (!context.maintenance && context.automation && context.automation_kinematics && context.kinematics_motor_enabled) == true },\n                                ],\n                            },\n\n                            running: {\n                                initial: 'init',\n                                on: {\n                                    KINEMATICS_STEPPER_MODE_0: {\n                                        actions: [assign({ kinematics_stepper_mode: 0 })],\n                                    },\n                                    KINEMATICS_STEPPER_MODE_1: {\n                                        actions: [assign({ kinematics_stepper_mode: 1 })],\n                                    },\n                                    KINEMATICS_STEPPER_MODE_2: {\n                                        actions: [assign({ kinematics_stepper_mode: 2 })],\n                                    },\n                                    KINEMATICS_STEPPER_MODE_3: {\n                                        actions: [assign({ kinematics_stepper_mode: 3 })],\n                                    },\n                                    KINEMATICS_STEPPER_MODE_10: {\n                                        actions: [assign({ kinematics_stepper_mode: 10 })],\n                                    },\n                                    KINEMATICS_STEPPER_MODE_11: {\n                                        actions: [assign({ kinematics_stepper_mode: 11 })],\n                                    },\n                                },\n                                states: {\n                                    init: {\n                                        always: [\n                                            { target: 'check_homing_valid'},\n                                        ],\n                                        onExit: ['callKinematicsStopMotor'], \n                                    },\n\n                                    check_homing_valid: {\n                                        entry: ['getKinematicsHomingValidState'],\n                                        after: {\n                                            1000: { target: 'check_homing_valid' }\n                                        },\n                                        on: {\n                                            KINEMATICS_HOMING_VALID_ON: {\n                                                actions: [assign({ kinematics_homing_valid: true })],\n                                                target: 'start_automation'\n                                            },\n                                            KINEMATICS_HOMING_VALID_OFF: {\n                                                actions: [assign({ kinematics_homing_valid: false })],\n                                                target: 'homing'\n                                            },\n                                        },\n                                    },\n\n                                    homing: {\n                                        entry: ['callKinematicsGlobalHoming'],\n                                        always: [\n                                            { target: 'check_homing_finished' },\n                                        ],\n                                    },\n\n                                    check_homing_finished: {\n                                        entry: ['getKinematicsStepperModeState', 'getKinematicsHomingValidState'],\n                                        after: {\n                                            1000: { target: 'check_homing_finished' }\n                                        },\n                                        always: [\n                                            { target: 'start_automation', cond: (context, event) => (context.kinematics_stepper_mode == 1) && (context.kinematics_homing_valid == true)},\n                                        ],\n                                    },\n\n                                    \n\n                                    start_automation: {\n\n                                    },\n\n                                    pictures: {\n\n                                    },\n\n                                    kinematics_automation: {\n\n                                    },\n\n                                    local_homing: {\n\n                                    }\n\n                                }\n                            },\n                        }\n                    },\n\n                    //led: {\n                    //    on: {\n                    //        LED_ON: {\n                    //            actions: [assign({ automation_kinematics: true })],\n                    //            target: 'led'\n                    //        },\n                    //        LED_OFF: {\n                    //            actions: [assign({ automation_kinematics: false })],\n                    //            target: 'led'\n                    //        },\n                    //    },\n                    //    initial: 'init',\n                    //    states: {\n                    //        init: {\n                    //        },\n                    //\n                    //        running: {\n                    //\n                    //        },\n                    //\n                    //        stopped: {\n                    //\n                    //        }\n                    //    }\n                    //},\n\n                    //pump: {\n                    //    on: {\n                    //        PUMP_ON: {\n                    //            actions: [assign({ automation_kinematics: true })],\n                    //            target: 'pump'\n                    //        },\n                    //        PUMP_OFF: {\n                    //            actions: [assign({ automation_kinematics: false })],\n                    //            target: 'pump'\n                    //        },\n                    //    },\n                    //    initial: 'init',\n                    //    states: {\n                    //        init: {\n                    //        },\n                    //\n                    //        running: {\n                    //\n                    //        },\n                    //\n                    //        stopped: {\n                    //\n                    //        }\n                    //    }\n                    //}\n                }\n\n            }\n        },\n    },\n    config: \n    {\n        guards: {\n           //check_states: (context, event) => {\n           //    return context.canSearch && event.query && event.query.length > 0\n           //    }\n        },\n\n        actions: {\n            getAutomationState: (context, event) => {\n                node.send({ command: 'get_automation_state', pcs: pcs});\n            },\n            getMaintenanceState: (context, event) => {\n                node.send({ command: 'get_maintenance_state', pcs: pcs });\n            },\n            getKinematicsState: (context, event) => {\n                node.send({ command: 'get_kinematics_state', pcs: pcs });\n            },\n            getKinematicsMotorState: (context, event) => {\n                node.send({ command: 'get_kinematics_motor_state', pcs: pcs});\n            },\n            getKinematicsHomingValidState: (context, event) => {\n                node.send({ command: 'get_kinematics_homing_valid_state', pcs: pcs });\n            },\n            getKinematicsStepperModeState: (context, event) => {\n                node.send({ command: 'get_kinematics_stepper_mode_state', pcs: pcs });\n            },\n\n            callKinematicsStopMotor: (context, event) => {\n                node.send({ command: 'call_Kinematics_stop_motor', pcs: pcs });\n            },\n            callKinematicsGlobalHoming: (context, event) => {\n                node.send({ command: 'call_Kinematics_global_homing', pcs: pcs });\n            },\n\n            \n            \n         }\n            \n    }\n}\n\n","noerr":0,"x":1140,"y":1040,"wires":[["0ba6a41169713dd8"],["13bef2a428f8780a","e324602c5324b1d1"]]},{"id":"963800d27f42b7e0","type":"function","z":"4d69908ddcfaac9c","name":"function 25","func":"var string = global.get('homeassistant.homeAssistant.states')[\"input_boolean.\" + msg.pcs + \"_mode_maintenance_active\"].state;\n\nmsg.result = global.get('homeassistant.homeAssistant.states')[\"input_boolean.\" + msg.pcs +\"_mode_maintenance_active\"].state;\nmsg.string = string;\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":2540,"wires":[["4f6ef5aded4861f2"]]},{"id":"e734e0901f86eb83","type":"inject","z":"4d69908ddcfaac9c","name":"","props":[{"p":"payload"},{"p":"pcs","v":"pcs1","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":620,"y":2560,"wires":[["963800d27f42b7e0"]]},{"id":"4f6ef5aded4861f2","type":"debug","z":"4d69908ddcfaac9c","name":"debug 15","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1180,"y":2600,"wires":[]},{"id":"0ba6a41169713dd8","type":"debug","z":"4d69908ddcfaac9c","name":"State","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1430,"y":1000,"wires":[]},{"id":"b7924b4f3fa4598e","type":"switch","z":"4d69908ddcfaac9c","name":"automation_states","property":"command","propertyType":"msg","rules":[{"t":"eq","v":"get_maintenance_state","vt":"str"},{"t":"eq","v":"get_automation_state","vt":"str"},{"t":"eq","v":"get_kinematics_state","vt":"str"},{"t":"eq","v":"get_kinematics_motor_state","vt":"str"},{"t":"eq","v":"get_led_state","vt":"str"},{"t":"eq","v":"get_pump_state","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":7,"x":210,"y":1280,"wires":[["a49b65541564d87a"],["8703bcfc35c77ce1"],["c79d847260390b28"],["64b593d796385977"],[],[],["bf7191acb616685c"]]},{"id":"13bef2a428f8780a","type":"debug","z":"4d69908ddcfaac9c","name":"State","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1430,"y":1080,"wires":[]},{"id":"325391e9819a15e4","type":"change","z":"4d69908ddcfaac9c","name":"MAINTENANCE_ON","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"MAINTENANCE_ON","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":800,"y":1140,"wires":[["d3b3077d3b65f1ce"]]},{"id":"d78e9d706be260f6","type":"change","z":"4d69908ddcfaac9c","name":"MAINTENANCE_OFF","rules":[{"t":"set","p":"topic","pt":"msg","to":"MAINTENANCE_OFF","tot":"str"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":800,"y":1180,"wires":[["d3b3077d3b65f1ce"]]},{"id":"1d0a4e53b236b57c","type":"change","z":"4d69908ddcfaac9c","name":"AUTOMATION_ON","rules":[{"t":"set","p":"topic","pt":"msg","to":"AUTOMATION_ON","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1220,"wires":[["73566d2d8e057e68"]]},{"id":"42d771de708d252c","type":"change","z":"4d69908ddcfaac9c","name":"AUTOMATION_OFF","rules":[{"t":"set","p":"topic","pt":"msg","to":"AUTOMATION_OFF","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1260,"wires":[["73566d2d8e057e68"]]},{"id":"2df15551b19d69d7","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_OFF","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_OFF","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1340,"wires":[["53e7b0d744ab813b"]]},{"id":"de95bb08ed23c8c9","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_ON","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_ON","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1300,"wires":[["53e7b0d744ab813b"]]},{"id":"8703bcfc35c77ce1","type":"subflow:fd625c48e8c8ae90","z":"4d69908ddcfaac9c","name":"","x":520,"y":1260,"wires":[["1d0a4e53b236b57c"],["42d771de708d252c"]]},{"id":"a49b65541564d87a","type":"subflow:564c0776b24ee8cb","z":"4d69908ddcfaac9c","name":"","x":530,"y":1180,"wires":[["325391e9819a15e4"],["d78e9d706be260f6"]]},{"id":"c79d847260390b28","type":"subflow:60792d08bd7f197a","z":"4d69908ddcfaac9c","name":"","x":500,"y":1340,"wires":[["de95bb08ed23c8c9"],["2df15551b19d69d7"]]},{"id":"1e16fd57834f4bab","type":"trigger-state","z":"4d69908ddcfaac9c","name":"maintenance","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"input_boolean.pcs1_mode_maintenance_active","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":450,"y":1140,"wires":[[],["6137b67513811099"]]},{"id":"7c4eed599efc134f","type":"trigger-state","z":"4d69908ddcfaac9c","name":"automation","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"input_boolean.pcs1_automation_main_active","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":450,"y":1220,"wires":[[],["423589478210e2d1"]]},{"id":"730f87b92e887b0c","type":"trigger-state","z":"4d69908ddcfaac9c","name":"kinematics","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"input_boolean.pcs1_automation_kinematics_active","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":460,"y":1300,"wires":[[],["20066711a76915df"]]},{"id":"6137b67513811099","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":1140,"wires":[["325391e9819a15e4"],["d78e9d706be260f6"]]},{"id":"423589478210e2d1","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":1220,"wires":[["1d0a4e53b236b57c"],["42d771de708d252c"]]},{"id":"20066711a76915df","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":1300,"wires":[["de95bb08ed23c8c9"],["2df15551b19d69d7"]]},{"id":"e324602c5324b1d1","type":"delay","z":"4d69908ddcfaac9c","name":"","pauseType":"delay","timeout":"200","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":440,"y":1060,"wires":[["0216d89de9c60617"]]},{"id":"64b593d796385977","type":"subflow:d8b948f39935830f","z":"4d69908ddcfaac9c","name":"","x":500,"y":1420,"wires":[["aaf9241b16a4f138"],["7bba9d0231ff42e2"]]},{"id":"aaf9241b16a4f138","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_MOTOR_ENABLED_ON","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_MOTOR_ENABLED_ON","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":1380,"wires":[["4627b5df7fc5784e"]]},{"id":"7bba9d0231ff42e2","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_MOTOR_ENABLED_OFF","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_MOTOR_ENABLED_OFF","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":860,"y":1420,"wires":[["4627b5df7fc5784e"]]},{"id":"8f698f16474d86ab","type":"trigger-state","z":"4d69908ddcfaac9c","name":"motor_enabled","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.pcs1_kin_stepper_enable_motor","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":440,"y":1380,"wires":[[],["ec202a9962a541d0"]]},{"id":"ec202a9962a541d0","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":1380,"wires":[["aaf9241b16a4f138"],["7bba9d0231ff42e2"]]},{"id":"bf7191acb616685c","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"command","propertyType":"msg","rules":[{"t":"eq","v":"get_kinematics_homing_valid_state","vt":"str"},{"t":"eq","v":"get_kinematics_stepper_mode_state","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":250,"y":1640,"wires":[["e1e9577e5e44c20d"],["85c9162c16a8dbba"],["8844b49f3c76d85d"]]},{"id":"e1e9577e5e44c20d","type":"subflow:3ce6ca2f6197961a","z":"4d69908ddcfaac9c","name":"","x":540,"y":1580,"wires":[["80bf21324096af2b"],["7754ba697c9bd884"]]},{"id":"80bf21324096af2b","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_HOMING_VALID_ON","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_HOMING_VALID_ON","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":1560,"wires":[["5cd0cd072ca0b8d9"]]},{"id":"7754ba697c9bd884","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_HOMING_VALID_OFF","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_HOMING_VALID_OFF","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":1600,"wires":[["5cd0cd072ca0b8d9"]]},{"id":"39c2892f0b5d5ea7","type":"trigger-state","z":"4d69908ddcfaac9c","name":"homing_valid","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.pcs1_kin_stepper_homing_is_valid","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":430,"y":1520,"wires":[[],["1d583cd0900c96f5"]]},{"id":"1d583cd0900c96f5","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":1520,"wires":[[],["08c1743ab2104129"]]},{"id":"271d9d17e85ea802","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"2.0","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":1620,"wires":[[],[]]},{"id":"94bb022f2e6bea4b","type":"trigger-state","z":"4d69908ddcfaac9c","name":"homing_valid","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.pcs1_kin_stepper_homing_is_valid","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":1010,"y":2140,"wires":[[],[]]},{"id":"85c9162c16a8dbba","type":"subflow:53bd181b0b773e57","z":"4d69908ddcfaac9c","name":"","x":500,"y":1880,"wires":[["dd0a80be02decf94"],["6dd8e1830a4e5b4d"],["1f9458b06ae75acd"],["4c424d5c7e8ad4eb"],["706a98b478ebb49e"],["e18a93c1ca8b27c3"],[]]},{"id":"706a98b478ebb49e","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_STEPPER_MODE_10","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_STEPPER_MODE_10","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":1860,"wires":[["801a95bfa47e4966"]]},{"id":"e18a93c1ca8b27c3","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_STEPPER_MODE_11","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_STEPPER_MODE_11","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":1900,"wires":[["801a95bfa47e4966"]]},{"id":"08c1743ab2104129","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_HOMING_VALID_OFF","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_HOMING_VALID_OFF_TRIGGER","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":1520,"wires":[["5cd0cd072ca0b8d9"]]},{"id":"b83e4245209825a5","type":"api-call-service","z":"4d69908ddcfaac9c","name":"stop_motor","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.{{pcs}}_kin_stepper_stop","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":590,"y":2060,"wires":[[]]},{"id":"8844b49f3c76d85d","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"command","propertyType":"msg","rules":[{"t":"eq","v":"call_Kinematics_stop_motor","vt":"str"},{"t":"eq","v":"call_Kinematics_global_homing","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":2100,"wires":[["b83e4245209825a5"],["3feed79c668b2b8e"]]},{"id":"4c424d5c7e8ad4eb","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_STEPPER_MODE_3","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_STEPPER_MODE_3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":1820,"wires":[["801a95bfa47e4966"]]},{"id":"1f9458b06ae75acd","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_STEPPER_MODE_2","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_STEPPER_MODE_2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":1780,"wires":[["801a95bfa47e4966"]]},{"id":"6dd8e1830a4e5b4d","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_STEPPER_MODE_1","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_STEPPER_MODE_1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":1740,"wires":[["801a95bfa47e4966"]]},{"id":"dd0a80be02decf94","type":"change","z":"4d69908ddcfaac9c","name":"KINEMATICS_STEPPER_MODE_0","rules":[{"t":"set","p":"topic","pt":"msg","to":"KINEMATICS_STEPPER_MODE_0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":1700,"wires":[["801a95bfa47e4966"]]},{"id":"95119205324e5929","type":"trigger-state","z":"4d69908ddcfaac9c","name":"stepper_mode","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"sensor.pcs1_kin_stepper_mode","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":410,"y":1720,"wires":[[],["37c27ae224f97573"]]},{"id":"37c27ae224f97573","type":"switch","z":"4d69908ddcfaac9c","name":"","property":"stepper_mode","propertyType":"msg","rules":[{"t":"eq","v":"0.0","vt":"str"},{"t":"eq","v":"1.0","vt":"str"},{"t":"eq","v":"2.0","vt":"str"},{"t":"eq","v":"3.0","vt":"str"},{"t":"eq","v":"10.0","vt":"str"},{"t":"eq","v":"11.0","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":7,"x":550,"y":1720,"wires":[["dd0a80be02decf94"],["6dd8e1830a4e5b4d"],["1f9458b06ae75acd"],["4c424d5c7e8ad4eb"],["706a98b478ebb49e"],["e18a93c1ca8b27c3"],[]]},{"id":"3feed79c668b2b8e","type":"api-call-service","z":"4d69908ddcfaac9c","name":"Homing","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"button","service":"press","entityId":"button.{{pcs}}_kin_stepper_start_global_homing","data":"","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":580,"y":2140,"wires":[[]]},{"id":"bf5145cbd4576c8c","type":"trigger-state","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"button.pcs1_cam1_snapshot","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":60,"wires":[[],["27b26dbbde49a7fc"]]},{"id":"07868bddaa38f021","type":"trigger-state","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"button.pcs1_cam2_snapshot","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":140,"wires":[[],["b844f4e58bae3fe2"]]},{"id":"bb5b37506aad5a84","type":"trigger-state","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"button.pcs1_cam3_snapshot","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":220,"wires":[[],["17129ebc6a72e2a2"]]},{"id":"9b077ec7e9fe29be","type":"trigger-state","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"button.pcs1_cam4_snapshot","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":300,"wires":[[],["98a76db1b75106cf"]]},{"id":"dcad76570f5dbf58","type":"trigger-state","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"button.pcs1_cam5_snapshot","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":380,"wires":[[],["cb71d33d91e3a73f"]]},{"id":"f90e664e01777516","type":"trigger-state","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"button.pcs1_cam6_snapshot","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":460,"wires":[[],["adc56685e4c4c711"]]},{"id":"1922eca2d3b939c4","type":"api-call-service","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & plant & \"_\" & angle & \"_\" & cam & \"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":1460,"y":260,"wires":[[]]},{"id":"d09e4c3205eb22fb","type":"change","z":"8ecde103e664eec0","name":"pcs1","rules":[{"t":"set","p":"pcs","pt":"msg","to":"pcs1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":260,"wires":[["fe7e27084f31f82c"]]},{"id":"43a5bb8bf8c926d5","type":"change","z":"8ecde103e664eec0","name":"cam6","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam6","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":460,"wires":[["d09e4c3205eb22fb"]]},{"id":"fe7e27084f31f82c","type":"subflow:6c80f1ca0dd2938f","z":"8ecde103e664eec0","name":"","x":1080,"y":260,"wires":[["4fa6b5a84a2c3d25"]]},{"id":"9f5014156fa00969","type":"change","z":"8ecde103e664eec0","name":"cam5","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam5","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":380,"wires":[["d09e4c3205eb22fb"]]},{"id":"629b0e57f24f2a47","type":"change","z":"8ecde103e664eec0","name":"cam4","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":300,"wires":[["d09e4c3205eb22fb"]]},{"id":"a8b3e1e342c9c93d","type":"change","z":"8ecde103e664eec0","name":"cam3","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":220,"wires":[["d09e4c3205eb22fb"]]},{"id":"d3014e0924a897a2","type":"change","z":"8ecde103e664eec0","name":"cam2","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":140,"wires":[["d09e4c3205eb22fb"]]},{"id":"43b64665bd7d669e","type":"change","z":"8ecde103e664eec0","name":"cam1","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":60,"wires":[["d09e4c3205eb22fb"]]},{"id":"29ad1169d5426c1a","type":"trigger-state","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"button.pcs1_cam7_snapshot","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":210,"y":540,"wires":[[],["89cadf81cc15e559"]]},{"id":"8ee19769765a14ad","type":"change","z":"8ecde103e664eec0","name":"cam7","rules":[{"t":"set","p":"cam","pt":"msg","to":"cam7","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":540,"wires":[["14b20e27953f4a42"]]},{"id":"77a9658c631f53a7","type":"api-call-service","z":"8ecde103e664eec0","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"camera","service":"snapshot","entityId":"camera.{{pcs}}_{{cam}}_camera","data":"{\"filename\": path & pcs & \"_\" & \"topview\" & \"_\" & angle & \"_\" & cam & \"_\" & global_angle &\"_\" & \"{{ now().strftime(\\\"%Y%m%d-%H%M%S\\\") }}.jpg\"}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":1460,"y":440,"wires":[[]]},{"id":"14b20e27953f4a42","type":"change","z":"8ecde103e664eec0","name":"pcs1","rules":[{"t":"set","p":"pcs","pt":"msg","to":"pcs1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":440,"wires":[["4df7ba51c3f6f068"]]},{"id":"4fa6b5a84a2c3d25","type":"subflow:d2fb9f710e7a6826","z":"8ecde103e664eec0","name":"","x":1250,"y":260,"wires":[["1922eca2d3b939c4"]]},{"id":"4df7ba51c3f6f068","type":"subflow:d2fb9f710e7a6826","z":"8ecde103e664eec0","name":"","x":1170,"y":440,"wires":[["77a9658c631f53a7"]]},{"id":"27b26dbbde49a7fc","type":"subflow:4e99185239cf91b2","z":"8ecde103e664eec0","name":"","x":510,"y":60,"wires":[["43b64665bd7d669e"]]},{"id":"b844f4e58bae3fe2","type":"subflow:4e99185239cf91b2","z":"8ecde103e664eec0","name":"","x":510,"y":140,"wires":[["d3014e0924a897a2"]]},{"id":"17129ebc6a72e2a2","type":"subflow:4e99185239cf91b2","z":"8ecde103e664eec0","name":"","x":510,"y":220,"wires":[["a8b3e1e342c9c93d"]]},{"id":"98a76db1b75106cf","type":"subflow:4e99185239cf91b2","z":"8ecde103e664eec0","name":"","x":510,"y":300,"wires":[["629b0e57f24f2a47"]]},{"id":"cb71d33d91e3a73f","type":"subflow:4e99185239cf91b2","z":"8ecde103e664eec0","name":"","x":510,"y":380,"wires":[["9f5014156fa00969"]]},{"id":"adc56685e4c4c711","type":"subflow:4e99185239cf91b2","z":"8ecde103e664eec0","name":"","x":510,"y":460,"wires":[["43a5bb8bf8c926d5"]]},{"id":"89cadf81cc15e559","type":"subflow:4e99185239cf91b2","z":"8ecde103e664eec0","name":"","x":510,"y":540,"wires":[["8ee19769765a14ad"]]},{"id":"63884053ccd8640c","type":"comment","z":"8ecde103e664eec0","name":"ausschalten, wenn automatik ein ist?","info":"","x":430,"y":20,"wires":[]},{"id":"80dc41578b609278","type":"comment","z":"2709ed20d07ea830","name":"Chatbot Configuration","info":"","x":120,"y":40,"wires":[]},{"id":"a07815afd5edd683","type":"telegram receiver","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","saveDataDir":"/config/www/photos/telegram/","filterCommands":true,"x":110,"y":80,"wires":[["94518195985a2eb0","aec621617fd3c929"],[]]},{"id":"d20dc6252e2e9a62","type":"function","z":"2709ed20d07ea830","name":"Save Original Message","func":"msg.telegram_message = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":80,"wires":[["68ef32afc4a49a44"]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"68ef32afc4a49a44","type":"switch","z":"2709ed20d07ea830","name":"","property":"payload.chatId","propertyType":"msg","rules":[{"t":"lt","v":"0","vt":"num"},{"t":"gt","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":80,"wires":[["9fdf55e33f02f3ba"],["ff27df9f8a9a92e0"]]},{"id":"1c41ac86cc152bef","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":60,"wires":[[]]},{"id":"9fdf55e33f02f3ba","type":"function","z":"2709ed20d07ea830","name":"Help Information Message","func":"var message =\n  `\n*Hello, i am the Plant Control System Bot*\n\n*Logging information\\\\:*\nI provide monitoring Information in this group like info, warning and error messages\\\\.\n\n*Status updates\\\\:*\nI also do provide a daily status message to let you know that the system is up and running\\\\.\n\nIf you do not receive that message, have a look on the situation on site to check if something went wrong\\\\.\n\n*Control and monitoring interface\\\\:*\nYou can send commands to a private chat with \\\\@protohaus\\\\_ofai\\\\_pcs\\\\_bot\\\\ to receive data and control the system\\\\.\n\nContact the group admins to get access to the private chat functionality\\\\.\n\n`;\n\n///pic pcs\\\\<number\\\\>\\\\_cam\\\\<number\\\\>\\\\: sends a picture of the requested camera (pcs\\\\: 1, cam: 1\\\\-7)\n//  / pic all\\\\: sends all camera pictures\n//  \nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1070,"y":60,"wires":[["1c41ac86cc152bef"]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"c097e34f3bd5698f","type":"subflow:ab1036a4c01aab80","z":"2709ed20d07ea830","name":"","x":1020,"y":260,"wires":[["fa74b3a9302f1f71"]]},{"id":"3e5b8775a83fa1f5","type":"subflow:48c607f195e854e0","z":"2709ed20d07ea830","x":1020,"y":300,"wires":[["81df7537e0155935"]]},{"id":"61d9cbd837178059","type":"subflow:b23737722e71b01c","z":"2709ed20d07ea830","x":1010,"y":340,"wires":[["aa92c16ac5f4ba51"]]},{"id":"e3106a65c5f9250e","type":"subflow:9e7ca1741a410453","z":"2709ed20d07ea830","x":1020,"y":380,"wires":[["06bb162d7128a209"]]},{"id":"4f5769ad82292928","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":990,"y":920,"wires":[[]]},{"id":"498322567513c93b","type":"function","z":"2709ed20d07ea830","name":"LED Panel max Temperature","func":"var message =\n  `\n*Warning*\nThe max\\\\. temperature somewhere on the led panel is above 35°C since 1 minute\\\\.\n\n`;\n\n///pic pcs\\\\<number\\\\>\\\\_cam\\\\<number\\\\>\\\\: sends a picture of the requested camera (pcs\\\\: 1, cam: 1\\\\-7)\n//  / pic all\\\\: sends all camera pictures\n//  \nmsg.payload = {}\nmsg.payload.type = 'message';\nmsg.payload.content = message;\nmsg.payload.chatId ='-1001698219543'\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":700,"y":920,"wires":[["4f5769ad82292928"]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"94518195985a2eb0","type":"delay","z":"2709ed20d07ea830","name":"limit","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"allowrate":false,"outputs":1,"x":270,"y":80,"wires":[["d20dc6252e2e9a62"]]},{"id":"7f63cdc16df19eef","type":"comment","z":"2709ed20d07ea830","name":"Info Channel Configuration","info":"","x":130,"y":560,"wires":[]},{"id":"ff27df9f8a9a92e0","type":"switch","z":"2709ed20d07ea830","name":"Commands","property":"originalMessage.text","propertyType":"msg","rules":[{"t":"eq","v":"/help","vt":"str"},{"t":"eq","v":"/heartbeat","vt":"str"},{"t":"cont","v":"/power","vt":"str"},{"t":"cont","v":"/pic","vt":"str"},{"t":"cont","v":"/sensor","vt":"str"},{"t":"cont","v":"/status","vt":"str"},{"t":"cont","v":"/restart","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":8,"x":770,"y":280,"wires":[["1eae9b738163016b"],["8bba143356d1b955"],["a63a24b48693882d"],["c097e34f3bd5698f"],["3e5b8775a83fa1f5"],["61d9cbd837178059"],["e3106a65c5f9250e"],["6b628bbfdbde2fe7"]]},{"id":"6b628bbfdbde2fe7","type":"function","z":"2709ed20d07ea830","name":"Information Message","func":"var message = \n`\n*Hello, i am the Plant Control System Bot*\n\nPlease send /help for more information on what commands you can use\\\\.\n\n`;\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode : \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":480,"wires":[["24ee802744cf149b"]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"8bba143356d1b955","type":"function","z":"2709ed20d07ea830","name":"Heartbeat Message","func":"var message = \n`\n*I am alive*\n\n`;\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview : true, \n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1050,"y":160,"wires":[["b95e9abd59218e41"]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"1eae9b738163016b","type":"function","z":"2709ed20d07ea830","name":"Help Message","func":"var message =\n  `\n*Hello, i am the Plant Control System Bot*\n\nYou can interact with me for monitoring and system control\\\\.\n \n*Choose one of the following commands\\\\:*\n/heartbeat\n/power \\\\- control the main power of the pcs units\n/pic \\\\- get live pictures from the cameras\n/sensor \\\\- get a live overview of the sensor data\n/status \\\\- get a status report of the system\n/restart \\\\- restart devices\n/help\n`;\n\n // /control \\\\- access actuators and devices\n // / automations \\\\- turn on / off automations\n // / parameters \\\\- change parameters for the control of the system\n\n\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1040,"y":120,"wires":[["b59501ce84f26a8d"]],"info":"## New message\n\nHello *markdown* formatted messages!'\n\nwith `inline` code\n\n> and quote\n>> nested\n\n\\`\\`\\`\nvar code = \"cool\";\n\\`\\`\\`\n\n| table | data |\n|---|---|\n| 1 | fred |\n| 2 | bob |\n\n_Italic_ **bold** "},{"id":"b59501ce84f26a8d","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":120,"wires":[[]]},{"id":"24ee802744cf149b","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":420,"wires":[[]]},{"id":"b95e9abd59218e41","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":160,"wires":[[]]},{"id":"fa74b3a9302f1f71","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":260,"wires":[[]]},{"id":"81df7537e0155935","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":300,"wires":[[]]},{"id":"aa92c16ac5f4ba51","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":340,"wires":[[]]},{"id":"06bb162d7128a209","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1330,"y":380,"wires":[[]]},{"id":"740fb05c7ac80888","type":"inject","z":"2709ed20d07ea830","name":"Daily trigger","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 09 * * *","once":false,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":120,"y":620,"wires":[["257a6541255b9730"]]},{"id":"8e0c4cabe1128ec6","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1450,"y":620,"wires":[[]]},{"id":"a63a24b48693882d","type":"subflow:ca65c1dbac21ab41","z":"2709ed20d07ea830","name":"","x":1010,"y":200,"wires":[["5a640f40a5389f9a"]]},{"id":"5a640f40a5389f9a","type":"telegram sender","z":"2709ed20d07ea830","name":"","bot":"a526e1d6acb6b7ab","haserroroutput":false,"outputs":1,"x":1370,"y":200,"wires":[[]]},{"id":"92f6ac9c9ea7c339","type":"template","z":"2709ed20d07ea830","name":"format it","field":"sensor_values","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*__Plant Control System 1 \\- Device Information__*\n\nPCS1 Main Power Supply\\: {{pcs1_main}}\nAtlas Scientific\\: {{pcs1_as_status}}\nCam 1\\: {{pcs1_cam1_status}}\nCam 2\\: {{pcs1_cam2_status}}\nCam 3\\: {{pcs1_cam3_status}}\nCam 4\\: {{pcs1_cam4_status}}\nCam 5\\: {{pcs1_cam5_status}}\nCam 6\\: {{pcs1_cam6_status}}\nCam 7\\: {{pcs1_cam7_status}}\nKinematics\\: {{pcs1_kin_status}}\nLED 1\\: {{pcs1_led1_status}}\nLED 2\\: {{pcs1_led2_status}}\nLED 3\\: {{pcs1_led3_status}}\nLED 4\\: {{pcs1_led4_status}}\nPWM\\: {{pcs1_pwm_status}}\nPump\\: {{pcs1_pump_status}}","output":"str","x":520,"y":1460,"wires":[["f8fa45eb4dc9cecf"]]},{"id":"f8fa45eb4dc9cecf","type":"function","z":"2709ed20d07ea830","name":"function 4","func":"var message = msg.sensor_values;\nmessage = msg.sensor_values.replace(/\\./g, \"\\\\.\");\nmsg.sensor_values = message;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2220,"y":1540,"wires":[["193f89b4e99dfedf"]]},{"id":"193f89b4e99dfedf","type":"function","z":"2709ed20d07ea830","name":"send message","func":"var message = msg.sensor_values;\nmsg.payload = msg.telegram_message;\nmsg.payload.type = 'message';\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2420,"y":1540,"wires":[[]]},{"id":"7867f50f842360c8","type":"function","z":"2709ed20d07ea830","name":"send message","func":"var message = msg.message;\nmsg.payload.content = message;\n\n// activate markdown\nmsg.payload.options = {\n  disable_web_page_preview: true,\n  parse_mode: \"MarkdownV2\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1220,"y":620,"wires":[["8e0c4cabe1128ec6"]]},{"id":"1cabd9b1eed72789","type":"function","z":"2709ed20d07ea830","name":"escapes","func":"var message = msg.message;\nmessage = msg.message.replace(/\\./g, \"\\\\.\");\nmsg.message = message;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":620,"wires":[["7867f50f842360c8"]]},{"id":"4796e46de4a9befe","type":"template","z":"2709ed20d07ea830","name":"format it","field":"message","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"*Info*\nHome Assistant\\: running\nMain Power Supply PCS1\\: {{pcs1_main}} \n","output":"str","x":840,"y":620,"wires":[["1cabd9b1eed72789"]]},{"id":"3bdb78e4bd694aca","type":"api-current-state","z":"2709ed20d07ea830","name":"pcs1_main","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.pcs1_main","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"pcs1_main","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":670,"y":620,"wires":[["4796e46de4a9befe"]]},{"id":"257a6541255b9730","type":"function","z":"2709ed20d07ea830","name":"function 6","func":"msg.payload = {}\nmsg.payload.type = 'message';\nmsg.payload.chatId = '-1001698219543'\n// activate markdown\nmsg.payload.options = {\n    disable_web_page_preview: true,\n    parse_mode: \"MarkdownV2\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":620,"wires":[["3bdb78e4bd694aca"]]},{"id":"ac5ad8a6567ca71a","type":"trigger-state","z":"2709ed20d07ea830","name":"pcs1_main on","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.pcs1_main","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":110,"y":700,"wires":[["257a6541255b9730"],[]]},{"id":"98b06753fe49c796","type":"trigger-state","z":"2709ed20d07ea830","name":"pcs1_main off","server":"f482c16b.7b4d","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"switch.pcs1_main","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":110,"y":760,"wires":[["257a6541255b9730"],[]]},{"id":"6a6619a52c966feb","type":"server-state-changed","z":"2709ed20d07ea830","name":"","server":"f482c16b.7b4d","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.pcs1_led_panel_average_max_temperature","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"35","halt_if_type":"num","halt_if_compare":"gt","outputs":2,"output_only_on_state_change":true,"for":"5","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":260,"y":920,"wires":[["498322567513c93b"],[]]},{"id":"aec621617fd3c929","type":"debug","z":"2709ed20d07ea830","name":"debug 7","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":340,"y":160,"wires":[]},{"id":"1d227ccfc4fed600","type":"inject","z":"c7fa6c57.aa19e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":120,"wires":[["fcc223bb5484e16f"]]},{"id":"fcc223bb5484e16f","type":"api-current-state","z":"c7fa6c57.aa19e","name":"pcs1_main_energy","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_datetime.date_test","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"$entity().attributes.timestamp","valueType":"jsonata"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":310,"y":120,"wires":[["34a696f51b9f9725","9aab3567f22ef30e"]]},{"id":"e56b40cacd6e2b6a","type":"debug","z":"c7fa6c57.aa19e","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1080,"y":140,"wires":[]},{"id":"ad0015b957556032","type":"inject","z":"c7fa6c57.aa19e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":180,"wires":[["736d008ef260cd9b"]]},{"id":"736d008ef260cd9b","type":"api-current-state","z":"c7fa6c57.aa19e","name":"pcs1_main_energy","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.date_time","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":310,"y":180,"wires":[["fc4d5d4c81622811"]]},{"id":"fc4d5d4c81622811","type":"debug","z":"c7fa6c57.aa19e","name":"debug 2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":680,"y":180,"wires":[]},{"id":"4c52965dbda6ce82","type":"api-call-service","z":"c7fa6c57.aa19e","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"input_datetime","service":"set_datetime","entityId":"input_datetime.date_test","data":"{\"time\": payload}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":740,"y":120,"wires":[["e56b40cacd6e2b6a"]]},{"id":"34a696f51b9f9725","type":"debug","z":"c7fa6c57.aa19e","name":"debug 3","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":540,"y":60,"wires":[]},{"id":"f66d94b813377fb5","type":"debug","z":"c7fa6c57.aa19e","name":"debug 5","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":740,"y":60,"wires":[]},{"id":"9aab3567f22ef30e","type":"function","z":"c7fa6c57.aa19e","name":"time","func":"const delay = 60;\nconst alarm = (msg.payload) + 60 * 60 * 1000;\nconst adjusted = new Date(alarm);\n\nmsg.payload = adjusted.toISOString().split('T')[1].split('.')[0];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":120,"wires":[["4c52965dbda6ce82","cef74e0eb3e8f4b4"]]},{"id":"cef74e0eb3e8f4b4","type":"debug","z":"c7fa6c57.aa19e","name":"debug 6","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":800,"y":240,"wires":[]},{"id":"5757a6c277d90543","type":"moment","z":"c7fa6c57.aa19e","name":"","topic":"","input":"date_test","inputType":"msg","inTz":"Europe/Berlin","adjAmount":"3","adjType":"minutes","adjDir":"subtract","format":"","locale":"C","output":"payload","outputType":"msg","outTz":"Europe/Berlin","x":840,"y":340,"wires":[["977b0c8734fab70d"]]},{"id":"6ff6dd56ed8ab415","type":"inject","z":"c7fa6c57.aa19e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":80,"y":460,"wires":[["e60157dd826cf591"]]},{"id":"e60157dd826cf591","type":"api-current-state","z":"c7fa6c57.aa19e","name":"date_test","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_datetime.day_start","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"date_test","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":240,"y":460,"wires":[["678106037c8c37ca"]]},{"id":"977b0c8734fab70d","type":"api-call-service","z":"c7fa6c57.aa19e","name":"","server":"f482c16b.7b4d","version":3,"debugenabled":false,"service_domain":"input_datetime","service":"set_datetime","entityId":"input_datetime.day_start","data":"{\"time\": payload}","dataType":"jsonata","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1200,"y":440,"wires":[[]]},{"id":"678106037c8c37ca","type":"api-current-state","z":"c7fa6c57.aa19e","name":"time_diff","server":"f482c16b.7b4d","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_number.time_diff","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"time_diff","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":440,"y":460,"wires":[["189860aeb349d03e"]]},{"id":"189860aeb349d03e","type":"switch","z":"c7fa6c57.aa19e","name":"","property":"time_diff","propertyType":"msg","rules":[{"t":"eq","v":"-3","vt":"num"},{"t":"eq","v":"-2","vt":"num"},{"t":"eq","v":"-1","vt":"num"},{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"}],"checkall":"true","repair":false,"outputs":7,"x":590,"y":460,"wires":[["5757a6c277d90543"],["dea616ad83729c8a"],["145d9f11845ec2e4"],["cc0b3e85612b3daa"],["a8154b820b59868e"],["df2e5f58a9e96d1b"],["5a627294df1e9780"]]},{"id":"dea616ad83729c8a","type":"moment","z":"c7fa6c57.aa19e","name":"","topic":"","input":"date_test","inputType":"msg","inTz":"Europe/Berlin","adjAmount":"2","adjType":"minutes","adjDir":"subtract","format":"","locale":"C","output":"payload","outputType":"msg","outTz":"Europe/Berlin","x":840,"y":380,"wires":[["977b0c8734fab70d"]]},{"id":"145d9f11845ec2e4","type":"moment","z":"c7fa6c57.aa19e","name":"","topic":"","input":"date_test","inputType":"msg","inTz":"Europe/Berlin","adjAmount":"1","adjType":"minutes","adjDir":"subtract","format":"","locale":"C","output":"payload","outputType":"msg","outTz":"Europe/Berlin","x":840,"y":420,"wires":[["977b0c8734fab70d"]]},{"id":"cc0b3e85612b3daa","type":"moment","z":"c7fa6c57.aa19e","name":"","topic":"","input":"date_test","inputType":"msg","inTz":"Europe/Berlin","adjAmount":"0","adjType":"minutes","adjDir":"add","format":"","locale":"C","output":"payload","outputType":"msg","outTz":"Europe/Berlin","x":840,"y":460,"wires":[["977b0c8734fab70d"]]},{"id":"a8154b820b59868e","type":"moment","z":"c7fa6c57.aa19e","name":"","topic":"","input":"date_test","inputType":"msg","inTz":"Europe/Berlin","adjAmount":"1","adjType":"minutes","adjDir":"add","format":"","locale":"C","output":"payload","outputType":"msg","outTz":"Europe/Berlin","x":840,"y":500,"wires":[["977b0c8734fab70d"]]},{"id":"df2e5f58a9e96d1b","type":"moment","z":"c7fa6c57.aa19e","name":"","topic":"","input":"date_test","inputType":"msg","inTz":"Europe/Berlin","adjAmount":"2","adjType":"minutes","adjDir":"add","format":"","locale":"C","output":"payload","outputType":"msg","outTz":"Europe/Berlin","x":840,"y":540,"wires":[["977b0c8734fab70d"]]},{"id":"5a627294df1e9780","type":"moment","z":"c7fa6c57.aa19e","name":"","topic":"","input":"date_test","inputType":"msg","inTz":"Europe/Berlin","adjAmount":"3","adjType":"minutes","adjDir":"add","format":"","locale":"C","output":"payload","outputType":"msg","outTz":"Europe/Berlin","x":840,"y":580,"wires":[["977b0c8734fab70d"]]},{"id":"c363ac69f6426299","type":"mqtt in","z":"0a84fcef42ddc94e","d":true,"name":"","topic":"#","qos":"2","datatype":"auto","broker":"090665a04fa6c385","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":40,"wires":[["b394058093f84240"]]},{"id":"b394058093f84240","type":"debug","z":"0a84fcef42ddc94e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":430,"y":120,"wires":[]},{"id":"960397ce4bbc7662","type":"comment","z":"0a84fcef42ddc94e","name":"Send the picture to the AI Server","info":"","x":950,"y":40,"wires":[]},{"id":"cb0d25c7b7b6aece","type":"comment","z":"0a84fcef42ddc94e","name":"save the picture to the server file system","info":"","x":300,"y":320,"wires":[]},{"id":"3b3c3b068dcdc6a0","type":"exec","z":"0a84fcef42ddc94e","d":true,"command":"curl --request POST 'http://192.168.178.201:8001/prediction/' --form 'file=@\"/path/to/image.jpg\"'","addpay":"","append":"","useSpawn":"false","timer":"","winHide":false,"oldrc":false,"name":"","x":470,"y":360,"wires":[[],[],[]]},{"id":"64045843ccf3be90","type":"http request","z":"0a84fcef42ddc94e","name":"accounts","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://fabman.io/api/v1/members","tls":"","persist":false,"proxy":"","authType":"bearer","senderr":false,"x":300,"y":440,"wires":[["c78c3ce82bb9f974"]]},{"id":"b0d01a6df724d8e6","type":"inject","z":"0a84fcef42ddc94e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":110,"y":440,"wires":[["64045843ccf3be90"]]},{"id":"c78c3ce82bb9f974","type":"debug","z":"0a84fcef42ddc94e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":550,"y":440,"wires":[]},{"id":"aa312f6f1d1f6fa7","type":"tcp out","z":"0a84fcef42ddc94e","name":"Send Signal","host":"192.168.99.12","port":"1234","beserver":"client","base64":false,"end":false,"x":530,"y":560,"wires":[]},{"id":"703676520359d407","type":"inject","z":"0a84fcef42ddc94e","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"\"Message:I\\n\"","payloadType":"str","x":170,"y":560,"wires":[["d8e111d4e3b55ce8"]]},{"id":"554dde7fb94b24c1","type":"debug","z":"0a84fcef42ddc94e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":530,"y":640,"wires":[]},{"id":"c43eb6d0.a40ec8","type":"inject","z":"0a84fcef42ddc94e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"[\"0x7B\",\"0x4D\",\"0x43\",\"0x00\",\"0x04\",\"0x1F\",\"0x0a\",\"0x08\",\"0x00\",\"0x0d\",\"0x7D\"]","payloadType":"bin","x":190,"y":620,"wires":[["aa312f6f1d1f6fa7","554dde7fb94b24c1"]]},{"id":"d8e111d4e3b55ce8","type":"function","z":"0a84fcef42ddc94e","name":"","func":"//const str = \"Hey. this is a string!\";\n\n// convert string to Buffer\n//const buff = Buffer.from(msg.payload, \"utf-8\");\nvar b = Buffer.from(msg.payload);\nmsg.payload = b;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":320,"y":560,"wires":[["aa312f6f1d1f6fa7","554dde7fb94b24c1"]]},{"id":"31d2a9ed5c5d5901","type":"mqtt out","z":"0a84fcef42ddc94e","name":"","topic":"test","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"090665a04fa6c385","x":690,"y":40,"wires":[]},{"id":"61481db6918f8409","type":"inject","z":"0a84fcef42ddc94e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"asassa111","payloadType":"str","x":560,"y":40,"wires":[["31d2a9ed5c5d5901"]]},{"id":"fc9b72ca994f8c65","type":"mqtt in","z":"0a84fcef42ddc94e","d":true,"name":"","topic":"fraunhofer-as-4417935ef20c/sensor/fraunhoferas4417935ef20cph/state","qos":"2","datatype":"auto","broker":"090665a04fa6c385","nl":false,"rap":true,"rh":0,"inputs":0,"x":380,"y":160,"wires":[["5c1fc6f7cc252803"]]},{"id":"5c1fc6f7cc252803","type":"debug","z":"0a84fcef42ddc94e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":750,"y":160,"wires":[]},{"id":"4910e0e72b93875a","type":"mqtt in","z":"0a84fcef42ddc94e","d":true,"name":"","topic":"fraunhofer-as-4417935ef20c/ph","qos":"2","datatype":"auto","broker":"090665a04fa6c385","nl":false,"rap":true,"rh":0,"inputs":0,"x":190,"y":220,"wires":[["de0d47101037e5ae"]]},{"id":"216994cffd7c5282","type":"debug","z":"0a84fcef42ddc94e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":610,"y":220,"wires":[]},{"id":"cc84c91ade7aa64c","type":"function","z":"0a84fcef42ddc94e","name":"function 7","func":"msg.payload = \"OFF\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":280,"wires":[["b2b547e5f1912399"]]},{"id":"b2b547e5f1912399","type":"mqtt out","z":"0a84fcef42ddc94e","d":true,"name":"","topic":"fraunhofer-as-4417935ef20c/switch/fraunhoferas4417935ef20crtdmqtt/state","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"090665a04fa6c385","x":1010,"y":240,"wires":[]},{"id":"5a8d0219d1a23f2a","type":"inject","z":"0a84fcef42ddc94e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":440,"y":260,"wires":[["cc84c91ade7aa64c"]]},{"id":"de0d47101037e5ae","type":"json","z":"0a84fcef42ddc94e","name":"","property":"payload","action":"","pretty":false,"x":430,"y":220,"wires":[["216994cffd7c5282"]]}]